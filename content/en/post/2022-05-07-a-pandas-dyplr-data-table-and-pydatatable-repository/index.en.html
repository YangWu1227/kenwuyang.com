---
title: A pandas, dyplr, data.table, and pydatatable Repository
author: Yang Wu
date: '2022-05-01'
slug: a-pandas-dyplr-data-table-and-pydatatable-repository
categories:
  - R
  - Python
tags:
  - R Programming
  - Python Programming
subtitle: ''
summary: 'A running list of everyday data wrangling code snippets'
authors: []
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
output:
  blogdown::html_page:
    toc: true
---


<div id="TOC">
<ul>
<li><a href="#motivation">Motivation</a>
<ul>
<li><a href="#packages-and-library">Packages and Library</a></li>
<li><a href="#dataframe-creation">DataFrame Creation</a></li>
<li><a href="#row-selection">Row Selection</a>
<ul>
<li><a href="#select-a-single-row">Select a single row</a></li>
<li><a href="#select-several-rows-by-their-indices">Select several rows by their indices</a></li>
<li><a href="#select-a-slice-of-rows-by-position">Select a slice of rows by position</a></li>
<li><a href="#select-every-second-row">Select every second row</a></li>
<li><a href="#select-all-rows-other-than-rows-1-2-3-and-9">Select all rows other than rows 1, 2, 3, and 9</a></li>
<li><a href="#select-rows-using-a-boolean-mask">Select rows using a boolean mask</a></li>
<li><a href="#select-rows-on-a-single-condition">Select rows on a single condition</a></li>
<li><a href="#select-rows-on-multiple-conditions-using-or">Select rows on multiple conditions, using OR</a></li>
<li><a href="#select-rows-on-multiple-conditions-using-and">Select rows on multiple conditions, using AND</a></li>
<li><a href="#select-rows-on-conditions-using-in">Select rows on conditions, using IN</a></li>
<li><a href="#filter-unique-rows">Filter unique rows</a></li>
<li><a href="#remove-missing-rows">Remove missing rows</a></li>
<li><a href="#randomly-sample-rows">Randomly sample rows</a></li>
<li><a href="#select-rows-using-regex">Select rows using regex</a></li>
<li><a href="#regex-replace-rows">Regex-replace rows</a></li>
<li><a href="#select-rows-between-a-numeric-range">Select rows between a numeric range</a></li>
</ul></li>
<li><a href="#column-selection">Column Selection</a>
<ul>
<li><a href="#select-a-single-column">Select a single column</a></li>
<li><a href="#select-a-single-column-by-position">Select a single column by position</a></li>
<li><a href="#select-multiple-columns">Select multiple columns</a></li>
<li><a href="#select-multiple-columns-by-position">Select multiple columns by position</a></li>
<li><a href="#select-multiple-columns-by-slicing-position">Select multiple columns by slicing (position)</a></li>
<li><a href="#select-multiple-columns-by-slicing-names">Select multiple columns by slicing (names)</a></li>
<li><a href="#select-multiple-columns-by-position-1">Select multiple columns by position</a></li>
<li><a href="#select-multiple-columns-by-slicing-position-1">Select multiple columns by slicing (position)</a></li>
<li><a href="#exclude-columns-by-name">Exclude columns by name</a></li>
<li><a href="#exclude-columns-by-position">Exclude columns by position</a></li>
<li><a href="#select-columns-using-regex">Select columns using regex</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<script src="/js/jquery-3.3.1.min.js"></script>
<script src="/js/show-hide-console-outputs.js"></script>
<style>
    h3 {
    text-align: center;
    font-size: 18px;
    font-weight: 600;
    margin-top: 0px;
    margin-bottom: 3px;
    }
</style>
<div id="motivation" class="section level1">
<h1>Motivation</h1>
<p>         The content and formatting of this post is inspired by the following comprehensive <a href="https://atrebas.github.io/post/2019-03-03-datatable-dplyr/">post</a> by <a href="https://atrebas.github.io/about/">Atrebas</a> and the pydatable <a href="https://datatable.readthedocs.io/en/latest/manual/index-manual.html">page</a>. You could also find Atrebas on Twitter <a href="https://twitter.com/atrebas">here</a>. I use both <code>R</code> and <code>Python</code> extensively in my work everyday, especially the data wrangling packages and library <code>data.table</code> (<code>pydatatable</code>), <code>dplyr</code> and <code>pandas</code>. I find that, in my case, I often have to translate between similar but different syntax when switching from one another. In <code>R</code>, there are ways to accomplishing tasks and there are more Pythonic ways to do things in <code>Python</code>. This is an attempt to create a list of code snippets that can hopefully become a reference for myself.</p>
<p>         The outputs of code blocks are hidden by default, but they may be shown by clicking the button below:</p>
<div style="text-align: center;">
<input type='button' id='hideshow' value='Show the outputs'>
</div>
<br>
<hr>
<div id="packages-and-library" class="section level2">
<h2>Packages and Library</h2>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="r"><code>library(tibble)
library(tidyr)
library(dplyr)
library(data.table)</code></pre>
</td>
<td align="left">
<pre class="python"><code>import pandas as pd
import numpy as np
from random import sample
from datatable import dt, f, by, g, join, sort, update, ifelse, first</code></pre>
</td>
</tr>
</tbody>
</table>
<br>
<hr>
</div>
<div id="dataframe-creation" class="section level2">
<h2>DataFrame Creation</h2>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
nums = sample(range(1, 20), 9)
PD = pd.DataFrame({
  &#39;A&#39;: nums,
  &#39;B&#39;: range(1, 10),
  &#39;C&#39;: [&quot;b&quot;]*3 + [&quot;a&quot;]*3 + [&quot;c&quot;]*3,
  &#39;D&#39;: [&#39;startswith_this&#39;, np.NaN, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, np.NaN, &#39;this_endwith&#39;, &#39;k&#39;, &#39;z&#39;]
})
PD </code></pre>
<pre><code>##     A  B  C                D
## 0  19  1  b  startswith_this
## 1   4  2  b              NaN
## 2  13  3  b                c
## 3   5  4  a                d
## 4   6  5  a                e
## 5  10  6  a              NaN
## 6  14  7  c     this_endwith
## 7   2  8  c                k
## 8  18  9  c                z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT = dt.Frame({
  &#39;A&#39;: nums,
  &#39;B&#39;: range(1, 10),
  &#39;C&#39;: [&quot;b&quot;]*3 + [&quot;a&quot;]*3 + [&quot;c&quot;]*3,
  &#39;D&#39;: [&#39;startswith_this&#39;, None, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, None, &#39;this_endwith&#39;, &#39;k&#39;, &#39;z&#39;]
})
PY_DT</code></pre>
<pre><code>##    |     A      B  C      D              
##    | int32  int32  str32  str32          
## -- + -----  -----  -----  ---------------
##  0 |    19      1  b      startswith_this
##  1 |     4      2  b      NA             
##  2 |    13      3  b      c              
##  3 |     5      4  a      d              
##  4 |     6      5  a      e              
##  5 |    10      6  a      NA             
##  6 |    14      7  c      this_endwith   
##  7 |     2      8  c      k              
##  8 |    18      9  c      z              
## [9 rows x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
TB &lt;- tibble(
  A = py$nums,
  B = 1:9,
  C = rep(c(&quot;b&quot;, &quot;a&quot;, &quot;c&quot;), each = 3),
  D = c(&quot;startswith_this&quot;, NA_character_, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, NA_character_, &quot;this_endwith&quot;, &quot;k&quot;, &quot;z&quot;)
)
TB</code></pre>
<pre><code>## # A tibble: 9 × 4
##       A     B C     D              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1    19     1 b     startswith_this
## 2     4     2 b     &lt;NA&gt;           
## 3    13     3 b     c              
## 4     5     4 a     d              
## 5     6     5 a     e              
## 6    10     6 a     &lt;NA&gt;           
## 7    14     7 c     this_endwith   
## 8     2     8 c     k              
## 9    18     9 c     z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT &lt;- data.table(
  A = py$nums,
  B = 1:9,
  C = rep(c(&quot;b&quot;, &quot;a&quot;, &quot;c&quot;), each = 3),
  D = c(&quot;startswith_this&quot;, NA_character_, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;, NA_character_, &quot;this_endwith&quot;, &quot;k&quot;, &quot;z&quot;)
)
R_DT</code></pre>
<pre><code>##     A B C               D
## 1: 19 1 b startswith_this
## 2:  4 2 b            &lt;NA&gt;
## 3: 13 3 b               c
## 4:  5 4 a               d
## 5:  6 5 a               e
## 6: 10 6 a            &lt;NA&gt;
## 7: 14 7 c    this_endwith
## 8:  2 8 c               k
## 9: 18 9 c               z</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="row-selection" class="section level2">
<h2>Row Selection</h2>
<div id="select-a-single-row" class="section level3">
<h3>Select a single row</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.loc[2]</code></pre>
<pre><code>## A    13
## B     3
## C     b
## D     c
## Name: 2, dtype: object</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[2, :]</code></pre>
<pre><code>##    |     A      B  C      D    
##    | int32  int32  str32  str32
## -- + -----  -----  -----  -----
##  0 |    13      3  b      c    
## [1 row x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
TB[2, ]
# Or
slice(TB, 2)</code></pre>
<pre><code>## # A tibble: 1 × 4
##       A     B C     D    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     4     2 b     &lt;NA&gt; 
## # A tibble: 1 × 4
##       A     B C     D    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     4     2 b     &lt;NA&gt;</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[2]</code></pre>
<pre><code>##    A B C    D
## 1: 4 2 b &lt;NA&gt;</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-several-rows-by-their-indices" class="section level3">
<h3>Select several rows by their indices</h3>
<p>Note that Python uses zero-based indexing.</p>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.iloc[[2, 3, 4], :]</code></pre>
<pre><code>##     A  B  C  D
## 2  13  3  b  c
## 3   5  4  a  d
## 4   6  5  a  e</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[[2, 3, 4], :]</code></pre>
<pre><code>##    |     A      B  C      D    
##    | int32  int32  str32  str32
## -- + -----  -----  -----  -----
##  0 |    13      3  b      c    
##  1 |     5      4  a      d    
##  2 |     6      5  a      e    
## [3 rows x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
TB[c(3, 4, 5), ]
# Or
slice(TB, c(3, 4, 5))</code></pre>
<pre><code>## # A tibble: 3 × 4
##       A     B C     D    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1    13     3 b     c    
## 2     5     4 a     d    
## 3     6     5 a     e    
## # A tibble: 3 × 4
##       A     B C     D    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1    13     3 b     c    
## 2     5     4 a     d    
## 3     6     5 a     e</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[c(3, 4, 5), ]
# OR
R_DT[c(3, 4, 5)] </code></pre>
<pre><code>##     A B C D
## 1: 13 3 b c
## 2:  5 4 a d
## 3:  6 5 a e
##     A B C D
## 1: 13 3 b c
## 2:  5 4 a d
## 3:  6 5 a e</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-a-slice-of-rows-by-position" class="section level3">
<h3>Select a slice of rows by position</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.iloc[2:5]
# Or
PD.iloc[range(2, 5)]</code></pre>
<pre><code>##     A  B  C  D
## 2  13  3  b  c
## 3   5  4  a  d
## 4   6  5  a  e
##     A  B  C  D
## 2  13  3  b  c
## 3   5  4  a  d
## 4   6  5  a  e</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[2:5, :]
# Or
PY_DT[range(2, 5), :]</code></pre>
<pre><code>##    |     A      B  C      D    
##    | int32  int32  str32  str32
## -- + -----  -----  -----  -----
##  0 |    13      3  b      c    
##  1 |     5      4  a      d    
##  2 |     6      5  a      e    
## [3 rows x 4 columns]
##    |     A      B  C      D    
##    | int32  int32  str32  str32
## -- + -----  -----  -----  -----
##  0 |    13      3  b      c    
##  1 |     5      4  a      d    
##  2 |     6      5  a      e    
## [3 rows x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
TB[3:5, ]
# Or
slice(TB, 3:5)</code></pre>
<pre><code>## # A tibble: 3 × 4
##       A     B C     D    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1    13     3 b     c    
## 2     5     4 a     d    
## 3     6     5 a     e    
## # A tibble: 3 × 4
##       A     B C     D    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1    13     3 b     c    
## 2     5     4 a     d    
## 3     6     5 a     e</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[3:5, ]
# Or
R_DT[3:5] </code></pre>
<pre><code>##     A B C D
## 1: 13 3 b c
## 2:  5 4 a d
## 3:  6 5 a e
##     A B C D
## 1: 13 3 b c
## 2:  5 4 a d
## 3:  6 5 a e</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-every-second-row" class="section level3">
<h3>Select every second row</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.iloc[::2]</code></pre>
<pre><code>##     A  B  C                D
## 0  19  1  b  startswith_this
## 2  13  3  b                c
## 4   6  5  a                e
## 6  14  7  c     this_endwith
## 8  18  9  c                z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[::2, :]</code></pre>
<pre><code>##    |     A      B  C      D              
##    | int32  int32  str32  str32          
## -- + -----  -----  -----  ---------------
##  0 |    19      1  b      startswith_this
##  1 |    13      3  b      c              
##  2 |     6      5  a      e              
##  3 |    14      7  c      this_endwith   
##  4 |    18      9  c      z              
## [5 rows x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
TB[seq.int(from = 1, to = nrow(TB), by = 2), ]
# Or
slice(TB, seq.int(from = 1, to = nrow(TB), by = 2))</code></pre>
<pre><code>## # A tibble: 5 × 4
##       A     B C     D              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1    19     1 b     startswith_this
## 2    13     3 b     c              
## 3     6     5 a     e              
## 4    14     7 c     this_endwith   
## 5    18     9 c     z              
## # A tibble: 5 × 4
##       A     B C     D              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1    19     1 b     startswith_this
## 2    13     3 b     c              
## 3     6     5 a     e              
## 4    14     7 c     this_endwith   
## 5    18     9 c     z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[seq.int(from = 1, to = nrow(TB), by = 2), ]
# Or
R_DT[seq.int(from = 1, to = nrow(TB), by = 2)] </code></pre>
<pre><code>##     A B C               D
## 1: 19 1 b startswith_this
## 2: 13 3 b               c
## 3:  6 5 a               e
## 4: 14 7 c    this_endwith
## 5: 18 9 c               z
##     A B C               D
## 1: 19 1 b startswith_this
## 2: 13 3 b               c
## 3:  6 5 a               e
## 4: 14 7 c    this_endwith
## 5: 18 9 c               z</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-all-rows-other-than-rows-1-2-3-and-9" class="section level3">
<h3>Select all rows other than rows 1, 2, 3, and 9</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
# Start at index 3 and stop at 8, and 1 step at a time
PD.iloc[slice(3, 8, None)]</code></pre>
<pre><code>##     A  B  C             D
## 3   5  4  a             d
## 4   6  5  a             e
## 5  10  6  a           NaN
## 6  14  7  c  this_endwith
## 7   2  8  c             k</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
# Start at index 3 and stop at 8, and 1 step at a time
PY_DT[slice(3, 8, None), :]</code></pre>
<pre><code>##    |     A      B  C      D           
##    | int32  int32  str32  str32       
## -- + -----  -----  -----  ------------
##  0 |     5      4  a      d           
##  1 |     6      5  a      e           
##  2 |    10      6  a      NA          
##  3 |    14      7  c      this_endwith
##  4 |     2      8  c      k           
## [5 rows x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
TB[-c(1:3, 9), ]
# Or
slice(TB, -c(1:3, 9))</code></pre>
<pre><code>## # A tibble: 5 × 4
##       A     B C     D           
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;       
## 1     5     4 a     d           
## 2     6     5 a     e           
## 3    10     6 a     &lt;NA&gt;        
## 4    14     7 c     this_endwith
## 5     2     8 c     k           
## # A tibble: 5 × 4
##       A     B C     D           
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;       
## 1     5     4 a     d           
## 2     6     5 a     e           
## 3    10     6 a     &lt;NA&gt;        
## 4    14     7 c     this_endwith
## 5     2     8 c     k</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[!c(1:3, 9), ] 
# Or 
R_DT[-c(1:3, 9), ]</code></pre>
<pre><code>##     A B C            D
## 1:  5 4 a            d
## 2:  6 5 a            e
## 3: 10 6 a         &lt;NA&gt;
## 4: 14 7 c this_endwith
## 5:  2 8 c            k
##     A B C            D
## 1:  5 4 a            d
## 2:  6 5 a            e
## 3: 10 6 a         &lt;NA&gt;
## 4: 14 7 c this_endwith
## 5:  2 8 c            k</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-rows-using-a-boolean-mask" class="section level3">
<h3>Select rows using a boolean mask</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
# Number of elements must match the number of rows
PD.iloc[[True, False, True] * 3]</code></pre>
<pre><code>##     A  B  C                D
## 0  19  1  b  startswith_this
## 2  13  3  b                c
## 3   5  4  a                d
## 5  10  6  a              NaN
## 6  14  7  c     this_endwith
## 8  18  9  c                z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[[True, False, True] * 3, :]</code></pre>
<pre><code>##    |     A      B  C      D              
##    | int32  int32  str32  str32          
## -- + -----  -----  -----  ---------------
##  0 |    19      1  b      startswith_this
##  1 |    13      3  b      c              
##  2 |     5      4  a      d              
##  3 |    10      6  a      NA             
##  4 |    14      7  c      this_endwith   
##  5 |    18      9  c      z              
## [6 rows x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
TB[rep(c(TRUE, FALSE, TRUE), 3), ]</code></pre>
<pre><code>## # A tibble: 6 × 4
##       A     B C     D              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1    19     1 b     startswith_this
## 2    13     3 b     c              
## 3     5     4 a     d              
## 4    10     6 a     &lt;NA&gt;           
## 5    14     7 c     this_endwith   
## 6    18     9 c     z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[rep(c(TRUE, FALSE, TRUE), 3), ]</code></pre>
<pre><code>##     A B C               D
## 1: 19 1 b startswith_this
## 2: 13 3 b               c
## 3:  5 4 a               d
## 4: 10 6 a            &lt;NA&gt;
## 5: 14 7 c    this_endwith
## 6: 18 9 c               z</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-rows-on-a-single-condition" class="section level3">
<h3>Select rows on a single condition</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.loc[PD[&#39;A&#39;] &gt; 9]</code></pre>
<pre><code>##     A  B  C                D
## 0  19  1  b  startswith_this
## 2  13  3  b                c
## 5  10  6  a              NaN
## 6  14  7  c     this_endwith
## 8  18  9  c                z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[f.A &gt; 9, :]</code></pre>
<pre><code>##    |     A      B  C      D              
##    | int32  int32  str32  str32          
## -- + -----  -----  -----  ---------------
##  0 |    19      1  b      startswith_this
##  1 |    13      3  b      c              
##  2 |    10      6  a      NA             
##  3 |    14      7  c      this_endwith   
##  4 |    18      9  c      z              
## [5 rows x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
filter(TB, A &gt; 9)</code></pre>
<pre><code>## # A tibble: 5 × 4
##       A     B C     D              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1    19     1 b     startswith_this
## 2    13     3 b     c              
## 3    10     6 a     &lt;NA&gt;           
## 4    14     7 c     this_endwith   
## 5    18     9 c     z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[A &gt; 9]
# Or set key for faster binary search
setkeyv(R_DT, cols = &quot;A&quot;)
R_DT[A &gt; 9] 
# Remove key
setkeyv(R_DT, cols = NULL)</code></pre>
<pre><code>##     A B C               D
## 1: 19 1 b startswith_this
## 2: 13 3 b               c
## 3: 10 6 a            &lt;NA&gt;
## 4: 14 7 c    this_endwith
## 5: 18 9 c               z
##     A B C               D
## 1: 10 6 a            &lt;NA&gt;
## 2: 13 3 b               c
## 3: 14 7 c    this_endwith
## 4: 18 9 c               z
## 5: 19 1 b startswith_this</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-rows-on-multiple-conditions-using-or" class="section level3">
<h3>Select rows on multiple conditions, using OR</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.loc[(PD[&#39;A&#39;] &gt; 9) | (PD[&#39;C&#39;] == &#39;b&#39;)]</code></pre>
<pre><code>##     A  B  C                D
## 0  19  1  b  startswith_this
## 1   4  2  b              NaN
## 2  13  3  b                c
## 5  10  6  a              NaN
## 6  14  7  c     this_endwith
## 8  18  9  c                z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[(f.A &gt; 9) | (f.C == &#39;b&#39;), :]</code></pre>
<pre><code>##    |     A      B  C      D              
##    | int32  int32  str32  str32          
## -- + -----  -----  -----  ---------------
##  0 |    19      1  b      startswith_this
##  1 |     4      2  b      NA             
##  2 |    13      3  b      c              
##  3 |    10      6  a      NA             
##  4 |    14      7  c      this_endwith   
##  5 |    18      9  c      z              
## [6 rows x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
filter(TB, A &gt; 9 | C == &#39;b&#39;)</code></pre>
<pre><code>## # A tibble: 6 × 4
##       A     B C     D              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1    19     1 b     startswith_this
## 2     4     2 b     &lt;NA&gt;           
## 3    13     3 b     c              
## 4    10     6 a     &lt;NA&gt;           
## 5    14     7 c     this_endwith   
## 6    18     9 c     z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[A &gt; 9 | C == &#39;b&#39;, ]
# Or set keys for faster binary search
setkeyv(R_DT, cols = c(&quot;A&quot;, &quot;C&quot;))
R_DT[A &gt; 9 | C == &#39;b&#39;, ] 
# Remove key
setkeyv(R_DT, cols = NULL)</code></pre>
<pre><code>##     A B C               D
## 1:  4 2 b            &lt;NA&gt;
## 2: 10 6 a            &lt;NA&gt;
## 3: 13 3 b               c
## 4: 14 7 c    this_endwith
## 5: 18 9 c               z
## 6: 19 1 b startswith_this
##     A B C               D
## 1:  4 2 b            &lt;NA&gt;
## 2: 10 6 a            &lt;NA&gt;
## 3: 13 3 b               c
## 4: 14 7 c    this_endwith
## 5: 18 9 c               z
## 6: 19 1 b startswith_this</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-rows-on-multiple-conditions-using-and" class="section level3">
<h3>Select rows on multiple conditions, using AND</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.loc[(PD[&#39;A&#39;] &gt; 9) &amp; (PD[&#39;C&#39;] == &#39;a&#39;)]</code></pre>
<pre><code>##     A  B  C    D
## 5  10  6  a  NaN</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[(f.A &gt; 9) &amp; (f.C == &#39;a&#39;), :]</code></pre>
<pre><code>##    |     A      B  C      D    
##    | int32  int32  str32  str32
## -- + -----  -----  -----  -----
##  0 |    10      6  a      NA   
## [1 row x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
filter(TB, A &gt; 9 &amp; C == &#39;a&#39;)</code></pre>
<pre><code>## # A tibble: 1 × 4
##       A     B C     D    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1    10     6 a     &lt;NA&gt;</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[A &gt; 9 &amp; C == &#39;a&#39;, ]
# Or set keys for faster binary search
setkeyv(R_DT, cols = c(&quot;A&quot;, &quot;C&quot;))
R_DT[A &gt; 9 &amp; C == &#39;a&#39;, ] 
# Remove key
setkeyv(R_DT, cols = NULL)</code></pre>
<pre><code>##     A B C    D
## 1: 10 6 a &lt;NA&gt;
##     A B C    D
## 1: 10 6 a &lt;NA&gt;</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-rows-on-conditions-using-in" class="section level3">
<h3>Select rows on conditions, using IN</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.loc[PD.C.isin((&#39;a&#39;, &#39;c&#39;))]</code></pre>
<pre><code>##     A  B  C             D
## 3   5  4  a             d
## 4   6  5  a             e
## 5  10  6  a           NaN
## 6  14  7  c  this_endwith
## 7   2  8  c             k
## 8  18  9  c             z</code></pre>
</td>
<td align="left">
<p>The <code>isin</code> functionality is currently missing but may be implemented; the solution below involves the <code>re.match</code> function, which was added in 1.1.0.</p>
<pre class="python"><code># Pydatatable
items = [&#39;a&#39;,&#39;c&#39;]
regex = f&quot;{&#39;|&#39;.join(items)}&quot;
regex
PY_DT[dt.re.match(column=f.C, pattern=regex), :]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
filter(TB, C %in% c(&quot;a&quot;, &quot;c&quot;))</code></pre>
<pre><code>## # A tibble: 6 × 4
##       A     B C     D           
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;       
## 1     5     4 a     d           
## 2     6     5 a     e           
## 3    10     6 a     &lt;NA&gt;        
## 4    14     7 c     this_endwith
## 5     2     8 c     k           
## 6    18     9 c     z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[C %chin% c(&quot;a&quot;, &quot;c&quot;), ]</code></pre>
<pre><code>##     A B C            D
## 1:  2 8 c            k
## 2:  5 4 a            d
## 3:  6 5 a            e
## 4: 10 6 a         &lt;NA&gt;
## 5: 14 7 c this_endwith
## 6: 18 9 c            z</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="filter-unique-rows" class="section level3">
<h3>Filter unique rows</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.drop_duplicates(subset=&#39;C&#39;, keep=&#39;first&#39;, inplace=False)</code></pre>
<pre><code>##     A  B  C                D
## 0  19  1  b  startswith_this
## 3   5  4  a                d
## 6  14  7  c     this_endwith</code></pre>
</td>
<td align="left">
<p>The <code>unique</code> functionality from <code>R</code> is currently not implemented. The solution below groups by the column in which we wish to look for duplicates, in which case the duplicated rows will be grouped together. Then, we keep the first row of each group.</p>
<pre class="python"><code># Pydatatable
PY_DT[:, first(f[:]), by(f.C)]</code></pre>
<pre><code>##    | C          A      B  D              
##    | str32  int32  int32  str32          
## -- + -----  -----  -----  ---------------
##  0 | a          5      4  d              
##  1 | b         19      1  startswith_this
##  2 | c         14      7  this_endwith   
## [3 rows x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
distinct(TB, C, .keep_all = T)</code></pre>
<pre><code>## # A tibble: 3 × 4
##       A     B C     D              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1    19     1 b     startswith_this
## 2     5     4 a     d              
## 3    14     7 c     this_endwith</code></pre>
</td>
<td align="left">
<p>The <code>duplicated</code> generic has a method defined for <code>data.table</code>, which returns a logical vector indicating which rows of a <code>data.table</code> are duplicates of a row with smaller subscripts. Note that for <code>data.table</code>, the returned unique rows returned may be different from those returned by <code>dplyr</code> and <code>pandas</code> since the rows are sorted by “C” first and foremost.</p>
<pre class="r"><code># Data.table
duplicated(R_DT, by = c(&quot;C&quot;))
# Duplicated rows removed by columns specified in &#39;by&#39; argument
setkeyv(R_DT, cols = &quot;C&quot;)
unique(R_DT, by = c(&quot;C&quot;))
setkeyv(R_DT, cols = NULL)</code></pre>
<pre><code>## [1] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE
##    A B C    D
## 1: 5 4 a    d
## 2: 4 2 b &lt;NA&gt;
## 3: 2 8 c    k</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="remove-missing-rows" class="section level3">
<h3>Remove missing rows</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.dropna(axis=0, subset=&#39;D&#39;, inplace=False)</code></pre>
<pre><code>##     A  B  C                D
## 0  19  1  b  startswith_this
## 2  13  3  b                c
## 3   5  4  a                d
## 4   6  5  a                e
## 6  14  7  c     this_endwith
## 7   2  8  c                k
## 8  18  9  c                z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
# Create a copy since &#39;del&#39; modifies in place
copy_PY_DT = PY_DT.copy()
del copy_PY_DT[f.D == None, :]
copy_PY_DT</code></pre>
<pre><code>##    |     A      B  C      D              
##    | int32  int32  str32  str32          
## -- + -----  -----  -----  ---------------
##  0 |    19      1  b      startswith_this
##  1 |    13      3  b      c              
##  2 |     5      4  a      d              
##  3 |     6      5  a      e              
##  4 |    14      7  c      this_endwith   
##  5 |     2      8  c      k              
##  6 |    18      9  c      z              
## [7 rows x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
drop_na(TB, D)</code></pre>
<pre><code>## # A tibble: 7 × 4
##       A     B C     D              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1    19     1 b     startswith_this
## 2    13     3 b     c              
## 3     5     4 a     d              
## 4     6     5 a     e              
## 5    14     7 c     this_endwith   
## 6     2     8 c     k              
## 7    18     9 c     z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
na.omit(R_DT, cols = &quot;D&quot;)</code></pre>
<pre><code>##     A B C               D
## 1:  5 4 a               d
## 2:  6 5 a               e
## 3: 13 3 b               c
## 4: 19 1 b startswith_this
## 5:  2 8 c               k
## 6: 14 7 c    this_endwith
## 7: 18 9 c               z</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="randomly-sample-rows" class="section level3">
<h3>Randomly sample rows</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.sample(
  n=5, 
  frac=None, 
  # Allow or disallow sampling of the same row more than once
  replace=False, 
  weights=None, 
  random_state=None, 
  # Defaults to 0 (index) for Series and DataFrames
  axis=None, 
  ignore_index=False
)
PD.sample(
  n=None, 
  frac=0.25, 
  # Allow or disallow sampling of the same row more than once
  replace=False, 
  weights=None, 
  random_state=None, 
  # Defaults to 0 (index) for Series and DataFrames
  axis=None, 
  ignore_index=False
)</code></pre>
<pre><code>##     A  B  C                D
## 0  19  1  b  startswith_this
## 7   2  8  c                k
## 2  13  3  b                c
## 6  14  7  c     this_endwith
## 1   4  2  b              NaN
##     A  B  C  D
## 2  13  3  b  c
## 7   2  8  c  k</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[sample(range(0, PY_DT.nrows), 5), :]
PY_DT[sample(range(0, PY_DT.nrows), int(PY_DT.nrows * 0.25)), :]</code></pre>
<pre><code>##    |     A      B  C      D              
##    | int32  int32  str32  str32          
## -- + -----  -----  -----  ---------------
##  0 |     5      4  a      d              
##  1 |    13      3  b      c              
##  2 |     6      5  a      e              
##  3 |    19      1  b      startswith_this
##  4 |     4      2  b      NA             
## [5 rows x 4 columns]
##    |     A      B  C      D           
##    | int32  int32  str32  str32       
## -- + -----  -----  -----  ------------
##  0 |    14      7  c      this_endwith
##  1 |    13      3  b      c           
## [2 rows x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
slice_sample(TB, n = 5)   
slice_sample(TB, prop = 0.25)</code></pre>
<pre><code>## # A tibble: 5 × 4
##       A     B C     D              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1    10     6 a     &lt;NA&gt;           
## 2    19     1 b     startswith_this
## 3     2     8 c     k              
## 4     6     5 a     e              
## 5     4     2 b     &lt;NA&gt;           
## # A tibble: 2 × 4
##       A     B C     D    
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;
## 1     6     5 a     e    
## 2    13     3 b     c</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[sample(.N, 5)]
R_DT[sample(.N, .N * 0.25)]</code></pre>
<pre><code>##     A B C            D
## 1:  2 8 c            k
## 2: 10 6 a         &lt;NA&gt;
## 3:  5 4 a            d
## 4: 13 3 b            c
## 5: 14 7 c this_endwith
##     A B C    D
## 1:  6 5 a    e
## 2: 10 6 a &lt;NA&gt;</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-rows-using-regex" class="section level3">
<h3>Select rows using regex</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<p>The argument <code>na</code> is the default value shown if element tested is not a string.</p>
<pre class="python"><code># Pandas
PD.loc[PD.D.str.startswith(&#39;startswith&#39;, na=False)]
PD.loc[PD.D.str.endswith(&#39;endwith&#39;, na=False)]</code></pre>
<pre><code>##     A  B  C                D
## 0  19  1  b  startswith_this
##     A  B  C             D
## 6  14  7  c  this_endwith</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[dt.re.match(column=f.D, pattern=&quot;^startswith&quot;), :]
PY_DT[dt.re.match(column=f.D, pattern=&quot;endwith$&quot;), :]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
filter(TB, grepl(&quot;^startswith&quot;, D))
filter(TB, grepl(&quot;endwith$&quot;, D))</code></pre>
<pre><code>## # A tibble: 1 × 4
##       A     B C     D              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1    19     1 b     startswith_this
## # A tibble: 1 × 4
##       A     B C     D           
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;       
## 1    14     7 c     this_endwith</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
# The functional form is like(vector, pattern, ignore.case = FALSE, fixed = FALSE)
R_DT[D %like% &quot;^startswith&quot;]
R_DT[D %like% &quot;endwith$&quot;]</code></pre>
<pre><code>##     A B C               D
## 1: 19 1 b startswith_this
##     A B C            D
## 1: 14 7 c this_endwith</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="regex-replace-rows" class="section level3">
<h3>Regex-replace rows</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
# Create a copy
copy_PD = PD.copy()
# Modify in place via subset-select-assign
copy_PD.loc[copy_PD.D.str.startswith(&#39;startswith&#39;, na=False), &#39;D&#39;] = &#39;replaced_start&#39;
copy_PD.loc[copy_PD.D.str.endswith(&#39;endwith&#39;, na=False), &#39;D&#39;] = &#39;replaced_end&#39;
copy_PD
# Replace all &#39;_&#39; with &#39; &#39;
copy_PD.replace(to_replace=&#39;_&#39;, value=&#39; &#39;, inplace=False, regex=True)
# Replace &#39;replaced&#39; with &#39;key&#39; and &#39;_&#39; with white space all at once
copy_PD.replace(to_replace=&#39;^replaced_&#39;, value=&#39;key &#39;, inplace=False, regex=True)</code></pre>
<pre><code>##     A  B  C               D
## 0  19  1  b  replaced_start
## 1   4  2  b             NaN
## 2  13  3  b               c
## 3   5  4  a               d
## 4   6  5  a               e
## 5  10  6  a             NaN
## 6  14  7  c    replaced_end
## 7   2  8  c               k
## 8  18  9  c               z
##     A  B  C               D
## 0  19  1  b  replaced start
## 1   4  2  b             NaN
## 2  13  3  b               c
## 3   5  4  a               d
## 4   6  5  a               e
## 5  10  6  a             NaN
## 6  14  7  c    replaced end
## 7   2  8  c               k
## 8  18  9  c               z
##     A  B  C          D
## 0  19  1  b  key start
## 1   4  2  b        NaN
## 2  13  3  b          c
## 3   5  4  a          d
## 4   6  5  a          e
## 5  10  6  a        NaN
## 6  14  7  c    key end
## 7   2  8  c          k
## 8  18  9  c          z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[dt.re.match(column=f.D, pattern=&quot;^startswith&quot;), f.D] = &#39;replaced_start&#39;
PY_DT[dt.re.match(column=f.D, pattern=&quot;endwith$&quot;), f.D] = &#39;replaced_end&#39;</code></pre>
</td>
<td align="left">
<p>Naively traverses the column <code>D</code> once with <code>stringr::str_detect</code>.</p>
<pre class="r"><code># Dplyr
mutate(TB,
  D = base::replace(
    D, stringr::str_detect(D, &quot;^startswith&quot;), &quot;replaced_start&quot;
  )
)
mutate(TB,
  D = base::replace(
    D, stringr::str_detect(D, &quot;endwith$&quot;), &quot;replaced_end&quot;
  )
)</code></pre>
<pre><code>## # A tibble: 9 × 4
##       A     B C     D             
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;         
## 1    19     1 b     replaced_start
## 2     4     2 b     &lt;NA&gt;          
## 3    13     3 b     c             
## 4     5     4 a     d             
## 5     6     5 a     e             
## 6    10     6 a     &lt;NA&gt;          
## 7    14     7 c     this_endwith  
## 8     2     8 c     k             
## 9    18     9 c     z             
## # A tibble: 9 × 4
##       A     B C     D              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1    19     1 b     startswith_this
## 2     4     2 b     &lt;NA&gt;           
## 3    13     3 b     c              
## 4     5     4 a     d              
## 5     6     5 a     e              
## 6    10     6 a     &lt;NA&gt;           
## 7    14     7 c     replaced_end   
## 8     2     8 c     k              
## 9    18     9 c     z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
# Create copy
copy_R_DT = copy(R_DT)
copy_R_DT[D %like% &quot;^startswith&quot;, D := &quot;replaced_start&quot;]
copy_R_DT[D %like% &quot;endwith$&quot;, D := &quot;replaced_end&quot;]
copy_R_DT</code></pre>
<pre><code>##     A B C              D
## 1:  5 4 a              d
## 2:  6 5 a              e
## 3: 10 6 a           &lt;NA&gt;
## 4:  4 2 b           &lt;NA&gt;
## 5: 13 3 b              c
## 6: 19 1 b replaced_start
## 7:  2 8 c              k
## 8: 14 7 c   replaced_end
## 9: 18 9 c              z</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-rows-between-a-numeric-range" class="section level3">
<h3>Select rows between a numeric range</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
# Possible values for &#39;inclusive&#39; are “both”, “neither”, “left”, “right”
PD[PD.A.between(left=7, right=15, inclusive=&#39;both&#39;)]</code></pre>
<pre><code>##     A  B  C             D
## 2  13  3  b             c
## 5  10  6  a           NaN
## 6  14  7  c  this_endwith</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[(f.A &gt;= 7) &amp; (f.A &lt;= 15), :]</code></pre>
<pre><code>##    |     A      B  C      D           
##    | int32  int32  str32  str32       
## -- + -----  -----  -----  ------------
##  0 |    13      3  b      c           
##  1 |    10      6  a      NA          
##  2 |    14      7  c      this_endwith
## [3 rows x 4 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
filter(TB, between(A, 7, 15))</code></pre>
<pre><code>## # A tibble: 3 × 4
##       A     B C     D           
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;       
## 1    13     3 b     c           
## 2    10     6 a     &lt;NA&gt;        
## 3    14     7 c     this_endwith</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[A %between% c(7, 15), ]
# Not inclusive
R_DT[data.table::between(A, 7, 14, incbounds = FALSE), ]</code></pre>
<pre><code>##     A B C            D
## 1: 10 6 a         &lt;NA&gt;
## 2: 13 3 b            c
## 3: 14 7 c this_endwith
##     A B C    D
## 1: 10 6 a &lt;NA&gt;
## 2: 13 3 b    c</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="column-selection" class="section level2">
<h2>Column Selection</h2>
<div id="select-a-single-column" class="section level3">
<h3>Select a single column</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
# PD.loc[:, &#39;D&#39;]
PD[&#39;D&#39;]</code></pre>
<pre><code>## 0    startswith_this
## 1                NaN
## 2                  c
## 3                  d
## 4                  e
## 5                NaN
## 6       this_endwith
## 7                  k
## 8                  z
## Name: D, dtype: object</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
# PY_DT[&#39;D&#39;]
# PY_DT[:, f.D]
PY_DT[:, &#39;D&#39;]</code></pre>
<pre><code>##    | D              
##    | str32          
## -- + ---------------
##  0 | startswith_this
##  1 | NA             
##  2 | c              
##  3 | d              
##  4 | e              
##  5 | NA             
##  6 | this_endwith   
##  7 | k              
##  8 | z              
## [9 rows x 1 column]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
# select(TB, D)
select(TB, &quot;D&quot;)</code></pre>
<pre><code>## # A tibble: 9 × 1
##   D              
##   &lt;chr&gt;          
## 1 startswith_this
## 2 &lt;NA&gt;           
## 3 c              
## 4 d              
## 5 e              
## 6 &lt;NA&gt;           
## 7 this_endwith   
## 8 k              
## 9 z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
# The drop argument preserver dimensionality in base R data frames
R_DT[, .(D), drop = FALSE]</code></pre>
<pre><code>##                  D
## 1:               d
## 2:               e
## 3:            &lt;NA&gt;
## 4:            &lt;NA&gt;
## 5:               c
## 6: startswith_this
## 7:               k
## 8:    this_endwith
## 9:               z</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-a-single-column-by-position" class="section level3">
<h3>Select a single column by position</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.iloc[:, 3]</code></pre>
<pre><code>## 0    startswith_this
## 1                NaN
## 2                  c
## 3                  d
## 4                  e
## 5                NaN
## 6       this_endwith
## 7                  k
## 8                  z
## Name: D, dtype: object</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
# PY_DT[:, 3]
PY_DT[3]</code></pre>
<pre><code>##    | D              
##    | str32          
## -- + ---------------
##  0 | startswith_this
##  1 | NA             
##  2 | c              
##  3 | d              
##  4 | e              
##  5 | NA             
##  6 | this_endwith   
##  7 | k              
##  8 | z              
## [9 rows x 1 column]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
select(TB, 4)</code></pre>
<pre><code>## # A tibble: 9 × 1
##   D              
##   &lt;chr&gt;          
## 1 startswith_this
## 2 &lt;NA&gt;           
## 3 c              
## 4 d              
## 5 e              
## 6 &lt;NA&gt;           
## 7 this_endwith   
## 8 k              
## 9 z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[, 4]</code></pre>
<pre><code>##                  D
## 1:               d
## 2:               e
## 3:            &lt;NA&gt;
## 4:            &lt;NA&gt;
## 5:               c
## 6: startswith_this
## 7:               k
## 8:    this_endwith
## 9:               z</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-multiple-columns" class="section level3">
<h3>Select multiple columns</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.loc[:, [&#39;A&#39;, &#39;B&#39;]]</code></pre>
<pre><code>##     A  B
## 0  19  1
## 1   4  2
## 2  13  3
## 3   5  4
## 4   6  5
## 5  10  6
## 6  14  7
## 7   2  8
## 8  18  9</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
# PY_DT[:, [&#39;A&#39;, &#39;B&#39;]]
PY_DT[:, [f.A, f.B]]</code></pre>
<pre><code>##    |     A      B
##    | int32  int32
## -- + -----  -----
##  0 |    19      1
##  1 |     4      2
##  2 |    13      3
##  3 |     5      4
##  4 |     6      5
##  5 |    10      6
##  6 |    14      7
##  7 |     2      8
##  8 |    18      9
## [9 rows x 2 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
select(TB, c(A, B))</code></pre>
<pre><code>## # A tibble: 9 × 2
##       A     B
##   &lt;int&gt; &lt;int&gt;
## 1    19     1
## 2     4     2
## 3    13     3
## 4     5     4
## 5     6     5
## 6    10     6
## 7    14     7
## 8     2     8
## 9    18     9</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[, .(A, B)]</code></pre>
<pre><code>##     A B
## 1:  5 4
## 2:  6 5
## 3: 10 6
## 4:  4 2
## 5: 13 3
## 6: 19 1
## 7:  2 8
## 8: 14 7
## 9: 18 9</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-multiple-columns-by-position" class="section level3">
<h3>Select multiple columns by position</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.iloc[:, [0, 3]]</code></pre>
<pre><code>##     A                D
## 0  19  startswith_this
## 1   4              NaN
## 2  13                c
## 3   5                d
## 4   6                e
## 5  10              NaN
## 6  14     this_endwith
## 7   2                k
## 8  18                z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[:, [0, 3]]</code></pre>
<pre><code>##    |     A  D              
##    | int32  str32          
## -- + -----  ---------------
##  0 |    19  startswith_this
##  1 |     4  NA             
##  2 |    13  c              
##  3 |     5  d              
##  4 |     6  e              
##  5 |    10  NA             
##  6 |    14  this_endwith   
##  7 |     2  k              
##  8 |    18  z              
## [9 rows x 2 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
select(TB, c(1, 4))</code></pre>
<pre><code>## # A tibble: 9 × 2
##       A D              
##   &lt;int&gt; &lt;chr&gt;          
## 1    19 startswith_this
## 2     4 &lt;NA&gt;           
## 3    13 c              
## 4     5 d              
## 5     6 e              
## 6    10 &lt;NA&gt;           
## 7    14 this_endwith   
## 8     2 k              
## 9    18 z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[, c(1, 4)]</code></pre>
<pre><code>##     A               D
## 1:  5               d
## 2:  6               e
## 3: 10            &lt;NA&gt;
## 4:  4            &lt;NA&gt;
## 5: 13               c
## 6: 19 startswith_this
## 7:  2               k
## 8: 14    this_endwith
## 9: 18               z</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-multiple-columns-by-slicing-position" class="section level3">
<h3>Select multiple columns by slicing (position)</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.iloc[:, 2:4]</code></pre>
<pre><code>##    C                D
## 0  b  startswith_this
## 1  b              NaN
## 2  b                c
## 3  a                d
## 4  a                e
## 5  a              NaN
## 6  c     this_endwith
## 7  c                k
## 8  c                z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[:, 2:4]</code></pre>
<pre><code>##    | C      D              
##    | str32  str32          
## -- + -----  ---------------
##  0 | b      startswith_this
##  1 | b      NA             
##  2 | b      c              
##  3 | a      d              
##  4 | a      e              
##  5 | a      NA             
##  6 | c      this_endwith   
##  7 | c      k              
##  8 | c      z              
## [9 rows x 2 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
select(TB, 4:3)</code></pre>
<pre><code>## # A tibble: 9 × 2
##   D               C    
##   &lt;chr&gt;           &lt;chr&gt;
## 1 startswith_this b    
## 2 &lt;NA&gt;            b    
## 3 c               b    
## 4 d               a    
## 5 e               a    
## 6 &lt;NA&gt;            a    
## 7 this_endwith    c    
## 8 k               c    
## 9 z               c</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[, 4:3]</code></pre>
<pre><code>##                  D C
## 1:               d a
## 2:               e a
## 3:            &lt;NA&gt; a
## 4:            &lt;NA&gt; b
## 5:               c b
## 6: startswith_this b
## 7:               k c
## 8:    this_endwith c
## 9:               z c</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-multiple-columns-by-slicing-names" class="section level3">
<h3>Select multiple columns by slicing (names)</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.loc[:, &#39;B&#39;:&#39;D&#39;]</code></pre>
<pre><code>##    B  C                D
## 0  1  b  startswith_this
## 1  2  b              NaN
## 2  3  b                c
## 3  4  a                d
## 4  5  a                e
## 5  6  a              NaN
## 6  7  c     this_endwith
## 7  8  c                k
## 8  9  c                z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[:, &#39;B&#39;:&#39;D&#39;]</code></pre>
<pre><code>##    |     B  C      D              
##    | int32  str32  str32          
## -- + -----  -----  ---------------
##  0 |     1  b      startswith_this
##  1 |     2  b      NA             
##  2 |     3  b      c              
##  3 |     4  a      d              
##  4 |     5  a      e              
##  5 |     6  a      NA             
##  6 |     7  c      this_endwith   
##  7 |     8  c      k              
##  8 |     9  c      z              
## [9 rows x 3 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
select(TB, B:D)</code></pre>
<pre><code>## # A tibble: 9 × 3
##       B C     D              
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;          
## 1     1 b     startswith_this
## 2     2 b     &lt;NA&gt;           
## 3     3 b     c              
## 4     4 a     d              
## 5     5 a     e              
## 6     6 a     &lt;NA&gt;           
## 7     7 c     this_endwith   
## 8     8 c     k              
## 9     9 c     z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[, .SD, .SDcols = B:D]</code></pre>
<pre><code>##    B C               D
## 1: 4 a               d
## 2: 5 a               e
## 3: 6 a            &lt;NA&gt;
## 4: 2 b            &lt;NA&gt;
## 5: 3 b               c
## 6: 1 b startswith_this
## 7: 8 c               k
## 8: 7 c    this_endwith
## 9: 9 c               z</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-multiple-columns-by-position-1" class="section level3">
<h3>Select multiple columns by position</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.iloc[:, [0, 3]]</code></pre>
<pre><code>##     A                D
## 0  19  startswith_this
## 1   4              NaN
## 2  13                c
## 3   5                d
## 4   6                e
## 5  10              NaN
## 6  14     this_endwith
## 7   2                k
## 8  18                z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[:, [0, 3]]</code></pre>
<pre><code>##    |     A  D              
##    | int32  str32          
## -- + -----  ---------------
##  0 |    19  startswith_this
##  1 |     4  NA             
##  2 |    13  c              
##  3 |     5  d              
##  4 |     6  e              
##  5 |    10  NA             
##  6 |    14  this_endwith   
##  7 |     2  k              
##  8 |    18  z              
## [9 rows x 2 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
select(TB, c(1, 4))</code></pre>
<pre><code>## # A tibble: 9 × 2
##       A D              
##   &lt;int&gt; &lt;chr&gt;          
## 1    19 startswith_this
## 2     4 &lt;NA&gt;           
## 3    13 c              
## 4     5 d              
## 5     6 e              
## 6    10 &lt;NA&gt;           
## 7    14 this_endwith   
## 8     2 k              
## 9    18 z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[, c(1, 4)]</code></pre>
<pre><code>##     A               D
## 1:  5               d
## 2:  6               e
## 3: 10            &lt;NA&gt;
## 4:  4            &lt;NA&gt;
## 5: 13               c
## 6: 19 startswith_this
## 7:  2               k
## 8: 14    this_endwith
## 9: 18               z</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-multiple-columns-by-slicing-position-1" class="section level3">
<h3>Select multiple columns by slicing (position)</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.iloc[:, 2:4]</code></pre>
<pre><code>##    C                D
## 0  b  startswith_this
## 1  b              NaN
## 2  b                c
## 3  a                d
## 4  a                e
## 5  a              NaN
## 6  c     this_endwith
## 7  c                k
## 8  c                z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
PY_DT[:, 2:4]</code></pre>
<pre><code>##    | C      D              
##    | str32  str32          
## -- + -----  ---------------
##  0 | b      startswith_this
##  1 | b      NA             
##  2 | b      c              
##  3 | a      d              
##  4 | a      e              
##  5 | a      NA             
##  6 | c      this_endwith   
##  7 | c      k              
##  8 | c      z              
## [9 rows x 2 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
select(TB, 4:3)</code></pre>
<pre><code>## # A tibble: 9 × 2
##   D               C    
##   &lt;chr&gt;           &lt;chr&gt;
## 1 startswith_this b    
## 2 &lt;NA&gt;            b    
## 3 c               b    
## 4 d               a    
## 5 e               a    
## 6 &lt;NA&gt;            a    
## 7 this_endwith    c    
## 8 k               c    
## 9 z               c</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[, 4:3]</code></pre>
<pre><code>##                  D C
## 1:               d a
## 2:               e a
## 3:            &lt;NA&gt; a
## 4:            &lt;NA&gt; b
## 5:               c b
## 6: startswith_this b
## 7:               k c
## 8:    this_endwith c
## 9:               z c</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="exclude-columns-by-name" class="section level3">
<h3>Exclude columns by name</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.drop(columns=[&#39;B&#39;, &#39;C&#39;], inplace = False)
# Second way
PD.loc[:, PD.columns.difference([&#39;B&#39;, &#39;C&#39;])]</code></pre>
<pre><code>##     A                D
## 0  19  startswith_this
## 1   4              NaN
## 2  13                c
## 3   5                d
## 4   6                e
## 5  10              NaN
## 6  14     this_endwith
## 7   2                k
## 8  18                z
##     A                D
## 0  19  startswith_this
## 1   4              NaN
## 2  13                c
## 3   5                d
## 4   6                e
## 5  10              NaN
## 6  14     this_endwith
## 7   2                k
## 8  18                z</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
# del PY_DT[: , [&#39;B&#39;, &#39;C&#39;]] 
PY_DT[:, f[:].remove([f.B, f.C])]</code></pre>
<pre><code>##    |     A  D              
##    | int32  str32          
## -- + -----  ---------------
##  0 |    19  startswith_this
##  1 |     4  NA             
##  2 |    13  c              
##  3 |     5  d              
##  4 |     6  e              
##  5 |    10  NA             
##  6 |    14  this_endwith   
##  7 |     2  k              
##  8 |    18  z              
## [9 rows x 2 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
select(TB, -c(B, C))</code></pre>
<pre><code>## # A tibble: 9 × 2
##       A D              
##   &lt;int&gt; &lt;chr&gt;          
## 1    19 startswith_this
## 2     4 &lt;NA&gt;           
## 3    13 c              
## 4     5 d              
## 5     6 e              
## 6    10 &lt;NA&gt;           
## 7    14 this_endwith   
## 8     2 k              
## 9    18 z</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[, .SD, .SDcols = !c(&quot;B&quot;, &quot;C&quot;)]
# Second way
R_DT[, !c(&quot;B&quot;, &quot;C&quot;)]
# Delete by reference
copied &lt;- copy(R_DT)
copied[, c(&quot;B&quot;, &quot;C&quot;) := NULL]
copied</code></pre>
<pre><code>##     A               D
## 1:  5               d
## 2:  6               e
## 3: 10            &lt;NA&gt;
## 4:  4            &lt;NA&gt;
## 5: 13               c
## 6: 19 startswith_this
## 7:  2               k
## 8: 14    this_endwith
## 9: 18               z
##     A               D
## 1:  5               d
## 2:  6               e
## 3: 10            &lt;NA&gt;
## 4:  4            &lt;NA&gt;
## 5: 13               c
## 6: 19 startswith_this
## 7:  2               k
## 8: 14    this_endwith
## 9: 18               z
##     A               D
## 1:  5               d
## 2:  6               e
## 3: 10            &lt;NA&gt;
## 4:  4            &lt;NA&gt;
## 5: 13               c
## 6: 19 startswith_this
## 7:  2               k
## 8: 14    this_endwith
## 9: 18               z</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="exclude-columns-by-position" class="section level3">
<h3>Exclude columns by position</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Pandas
PD.drop(PD.columns[[1, 2, 3]], axis=1, inplace=False)</code></pre>
<pre><code>##     A
## 0  19
## 1   4
## 2  13
## 3   5
## 4   6
## 5  10
## 6  14
## 7   2
## 8  18</code></pre>
</td>
<td align="left">
<pre class="python"><code># Pydatatable
# Deselecting 
PY_DT[:, [pos for pos in range(PY_DT.ncols) if pos not in [1, 2, 3]]]
# Deleting in place
copied = PY_DT.copy()
del copied[:, [1, 2, 3]]
copied</code></pre>
<pre><code>##    |     A
##    | int32
## -- + -----
##  0 |    19
##  1 |     4
##  2 |    13
##  3 |     5
##  4 |     6
##  5 |    10
##  6 |    14
##  7 |     2
##  8 |    18
## [9 rows x 1 column]
##    |     A
##    | int32
## -- + -----
##  0 |    19
##  1 |     4
##  2 |    13
##  3 |     5
##  4 |     6
##  5 |    10
##  6 |    14
##  7 |     2
##  8 |    18
## [9 rows x 1 column]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Dplyr
select(TB, -c(2, 3, 4))</code></pre>
<pre><code>## # A tibble: 9 × 1
##       A
##   &lt;int&gt;
## 1    19
## 2     4
## 3    13
## 4     5
## 5     6
## 6    10
## 7    14
## 8     2
## 9    18</code></pre>
</td>
<td align="left">
<pre class="r"><code># Data.table
R_DT[, !c(2, 3, 4)]
# Delete by reference
copied &lt;- copy(R_DT)
copied[, c(2, 3, 4) := NULL]
copied</code></pre>
<pre><code>##     A
## 1:  5
## 2:  6
## 3: 10
## 4:  4
## 5: 13
## 6: 19
## 7:  2
## 8: 14
## 9: 18
##     A
## 1:  5
## 2:  6
## 3: 10
## 4:  4
## 5: 13
## 6: 19
## 7:  2
## 8: 14
## 9: 18</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
<div id="select-columns-using-regex" class="section level3">
<h3>Select columns using regex</h3>
<table class="table table-condensed">
<tbody>
<tr>
<td align="left">
<pre class="python"><code># Import re
from re import match
# Add three columns with prefixes
NEW_PD = pd.concat(
  (PD, pd.DataFrame(
    {&#39;prefix_D&#39;: list(range(0, 9)),
    &#39;prefix_F&#39;: list(range(0, 9)),
    &#39;prefix_G&#39;: list(range(0, 9))}
  )),
  axis=1)
# Pandas
NEW_PD.filter(regex=&#39;^prefix_&#39;, axis=1)
# Second way via list comp
NEW_PD.loc[:, [col for col in NEW_PD.columns if match(r&#39;^prefix_&#39;, col)]]</code></pre>
<pre><code>##    prefix_D  prefix_F  prefix_G
## 0         0         0         0
## 1         1         1         1
## 2         2         2         2
## 3         3         3         3
## 4         4         4         4
## 5         5         5         5
## 6         6         6         6
## 7         7         7         7
## 8         8         8         8
##    prefix_D  prefix_F  prefix_G
## 0         0         0         0
## 1         1         1         1
## 2         2         2         2
## 3         3         3         3
## 4         4         4         4
## 5         5         5         5
## 6         6         6         6
## 7         7         7         7
## 8         8         8         8</code></pre>
</td>
<td align="left">
<pre class="python"><code># Add columns with prefix
copied = PY_DT.copy()
# Updates in place
copied[:, update(prefix_D = 3, prefix_F = 4, prefix_G = 4)]
# Pydatatable
copied[:, [col for col in copied.names if match(r&#39;^prefix_&#39;, col)]]</code></pre>
<pre><code>##    | prefix_D  prefix_F  prefix_G
##    |    int32     int32     int32
## -- + --------  --------  --------
##  0 |        3         4         4
##  1 |        3         4         4
##  2 |        3         4         4
##  3 |        3         4         4
##  4 |        3         4         4
##  5 |        3         4         4
##  6 |        3         4         4
##  7 |        3         4         4
##  8 |        3         4         4
## [9 rows x 3 columns]</code></pre>
</td>
<td align="left">
<pre class="r"><code># Add columns with prefix
copied = mutate(
  TB, 
  prefix_D = sample(100, size = nrow(TB)), 
  prefix_F = 3,
  prefix_G = &#39;F&#39;)
# contains(&quot;pattern&quot;)
# ends_with(&quot;pattern&quot;)
# matches(&quot;pattern&quot;) matches a regular expression
# Dplyr
select(copied, starts_with(&quot;prefix_&quot;))</code></pre>
<pre><code>## # A tibble: 9 × 3
##   prefix_D prefix_F prefix_G
##      &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;   
## 1       63        3 F       
## 2       45        3 F       
## 3       13        3 F       
## 4       68        3 F       
## 5       70        3 F       
## 6       60        3 F       
## 7       23        3 F       
## 8       39        3 F       
## 9       74        3 F</code></pre>
</td>
<td align="left">
<p>We can filter columns to include in <code>.SD</code> based on their names according to regular expressions via <code>.SDcols=patterns(regex1, regex2, ...)</code>. The included columns will be the <strong>intersection</strong> of the columns identified by each pattern; pattern <strong>unions</strong> can easily be specified with <code>|</code> in a regex.</p>
<pre class="r"><code># Data.table
# Add columns with prefix
copied = copy(R_DT)
copied[, c(&quot;prefix_D&quot;, &quot;prefix_F&quot;, &quot;prefix_G&quot;) := .(4, 33, 5)]
# Data.table
copied[, .SD, .SDcols = patterns(&quot;^prefix_&quot;)]</code></pre>
<pre><code>##    prefix_D prefix_F prefix_G
## 1:        4       33        5
## 2:        4       33        5
## 3:        4       33        5
## 4:        4       33        5
## 5:        4       33        5
## 6:        4       33        5
## 7:        4       33        5
## 8:        4       33        5
## 9:        4       33        5</code></pre>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
