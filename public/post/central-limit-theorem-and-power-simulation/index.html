<!DOCTYPE html><html lang="en-us" >

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.3.0 for Hugo" />
  

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Yang (Ken) Wu" />

  
  
  
    
  
  <meta name="description" content="An implementation of the Central Limit Theorem in R and Power Simulation" />

  
  <link rel="alternate" hreflang="en-us" href="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/" />

  









  




  
  

  
  
  
    <meta name="theme-color" content="#707070" />
  

  
  
    
    <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.ac7c0ed2b158b87562a0b9c331d7a57e.css" />

  



  

  

  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/" />

  
  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image" />
  
  <meta property="og:site_name" content="Yang (Ken) Wu" />
  <meta property="og:url" content="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/" />
  <meta property="og:title" content="The Central Limit Theorem and Power Simulation | Yang (Ken) Wu" />
  <meta property="og:description" content="An implementation of the Central Limit Theorem in R and Power Simulation" /><meta property="og:image" content="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/featured.jpeg" />
    <meta property="twitter:image" content="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/featured.jpeg" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2020-11-04T21:13:14-05:00"
      />
    
    <meta property="article:modified_time" content="2020-11-04T21:13:14-05:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/"
  },
  "headline": "The Central Limit Theorem and Power Simulation",
  
  "image": [
    "https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/featured.jpeg"
  ],
  
  "datePublished": "2020-11-04T21:13:14-05:00",
  "dateModified": "2020-11-04T21:13:14-05:00",
  
  "author": {
    "@type": "Person",
    "name": "Yang (Ken) Wu"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Yang (Ken) Wu",
    "logo": {
      "@type": "ImageObject",
      "url": "https://academic-demo.netlify.app/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "An implementation of the Central Limit Theorem in R and Power Simulation"
}
</script>

  

  

  

  





  <title>The Central Limit Theorem and Power Simulation | Yang (Ken) Wu</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="beb7b9488f3f71c9a8fb264bf47f165f" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.8988fb2a4bba758785868cfcb5244555.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">Yang (Ken) Wu</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">Yang (Ken) Wu</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
          
          <li class="nav-item d-none d-lg-inline-flex">
            <a class="nav-link" href="https://www.instagram.com/kennywu12/" data-toggle="tooltip" data-placement="bottom" title="Follow me on Instgram" target="_blank" rel="noopener" aria-label="Follow me on Instgram">
              <i class="fab fa-instagram" aria-hidden="true"></i>
            </a>
          </li>
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <article class="article">

  




















  
  


<div class="article-container pt-3">
  <h1>The Central Limit Theorem and Power Simulation</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Wednesday, 04 Nov 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    12 min read
  </span>
  

  
  
  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/category/r/">R</a></span>
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 713px; max-height: 500px;">
  <div style="position: relative">
    <img src="/post/central-limit-theorem-and-power-simulation/featured.jpeg" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/header-attrs/header-attrs.js"></script>
<script src="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/htmlwidgets/htmlwidgets.js"></script>
<script src="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/plotly-binding/plotly.js"></script>
<script src="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/typedarray/typedarray.min.js"></script>
<script src="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/jquery/jquery.min.js"></script>
<link href="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/crosstalk/js/crosstalk.min.js"></script>
<link href="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/plotly-main/plotly-latest.min.js"></script>


<div id="central-limit-theorem" class="section level2">
<h2>Central Limit Theorem</h2>
<p>The central limit theorem, crudely speaking, states that— if there is a distriubtion with expected value given by the mean <span class="math inline">\(\mu\)</span> and finite variance <span class="math inline">\(\sigma^2\)</span> and we take <em>sufficiently</em> large random samples from this distribution with replacement, then the distribution of the sample means will be <em>approximately</em> normally distributed. This will hold true regardless of whether the source or “parent” distribution is normal, conditional on the fact that the sample size is sufficiently large (say, n &gt; 30). Below we demonstrate two characteristics of the CLT:</p>
<ol style="list-style-type: decimal">
<li><p>The mean of the distribution of sample means, <span class="math inline">\(\mu_{\bar{x}}\)</span> should converge towards the mean of the “parent population,” the population from which the random samples are drawn, as <span class="math inline">\(n \to \infty\)</span>.</p></li>
<li><p>The standard deviation of the distribution of sample means, also known as the standard error of the mean, <span class="math inline">\(\sigma_{\bar{x}}= \frac{\sigma}{\sqrt{n}}\)</span>, should become smaller as <span class="math inline">\(n \to \infty\)</span>. In other words, the spread of the distribution of sample means should decrease as sample size, n, increases.</p></li>
</ol>
<p>Here, we examine a poisson distribution <span class="math inline">\(X\sim pois(220/24)\)</span>:</p>
<pre class="r"><code># Lambda is the number of geese that arrive per hour
lambda &lt;- 220 / 24
# Number of random samples to be drawn
numsim &lt;- 10000
# Initialize variables
mean5 &lt;- rep(0, numsim)
mean15 &lt;- rep(0, numsim)
mean30 &lt;- rep(0, numsim)
mean100 &lt;- rep(0, numsim)
mean200 &lt;- rep(0, numsim)
# Loop for simulating
for (i in 1:numsim) {

  # sample means
  mean5[i] &lt;- mean(rpois(5, lambda))
  mean15[i] &lt;- mean(rpois(15, lambda))
  mean30[i] &lt;- mean(rpois(30, lambda))
  mean100[i] &lt;- mean(rpois(100, lambda))
  mean200[i] &lt;- mean(rpois(200, lambda))
}
# Create five data frames for these sampling distributions with varying sample sizes
# Create a variable &quot;sample_size&quot; used as an identifier
n_5 &lt;- data.frame(sample_size = as.factor(rep(5, 10000)), sample_means = mean5)
n_15 &lt;- data.frame(sample_size = as.factor(rep(15, 10000)), sample_means = mean15)
n_30 &lt;- data.frame(sample_size = as.factor(rep(30, 10000)), sample_means = mean30)
n_100 &lt;- data.frame(sample_size = as.factor(rep(100, 10000)), sample_means = mean100)
n_200 &lt;- data.frame(sample_size = as.factor(rep(200, 10000)), sample_means = mean200)
# Combine into a single data frame
# rbind() combines data frames by rows
sampling_distributions &lt;- rbind(n_5, n_15, n_30, n_100, n_200)</code></pre>
<p>The first characteristic of the CLT states that <span class="math inline">\(\mu_{\bar{x}}\)</span> should converge towards <span class="math inline">\(\lambda= 9.1667\)</span> as <span class="math inline">\(n \to \infty\)</span>. Let’s check:</p>
<pre class="r"><code># Using tapply
round(tapply(
  sampling_distributions$sample_means,
  sampling_distributions$sample_size, mean
), digits = 5)</code></pre>
<pre><code>      5      15      30     100     200 
9.15432 9.17101 9.16610 9.17031 9.16850 </code></pre>
<p>As can be seen, <span class="math inline">\(\mu_{\bar{x}}\)</span> gets closer and closer to <span class="math inline">\(\lambda= 9.1667\)</span> as sample size becomes larger. For the second characteristic, let’s examine the overlay density plots of these sampling distributions:</p>
<pre class="r"><code># Using ggplot()
p &lt;- ggplot(data = sampling_distributions, aes(x = sample_means))
p &lt;- p + geom_density(aes(fill = sample_size, color = sample_size), alpha = 0.2)
p &lt;- p + geom_vline(xintercept = lambda, linetype = &quot;dashed&quot;)
p &lt;- p + ggtitle(&quot;Density Plot of Sampling Distributions&quot;)
p &lt;- p + xlab(&quot;Distributions of Sample Means&quot;) + ylab(&quot;Density&quot;)
p &lt;- p + theme(panel.background = element_rect(fill = &quot;azure2&quot;))
p</code></pre>
<p><img src="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/figure-html/unnamed-chunk-3-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>The dashed line in the figure above indicates <span class="math inline">\(\lambda= 9.1667\)</span>. Evidently, as sample size gets larger, the spread of the distribution of sample means gets smaller. We have a visual confirmation of the CTL that standard error of the mean should become smaller as <span class="math inline">\(n \to \infty\)</span>. Below, we compute the standard deviations of these distributions:</p>
<pre class="r"><code># Using tapply
round(tapply(sampling_distributions$sample_means, sampling_distributions$sample_size, sd), digits = 5)</code></pre>
<pre><code>      5      15      30     100     200 
1.34549 0.77477 0.54653 0.29724 0.21252 </code></pre>
<p>Now, we have a numeric proof of this characteristic as well. Additionally, we may also compare these simulated values to our analytical solutions. We know that the standard deviation of a poisson distribution is simply the square root of the mean, <span class="math inline">\(\lambda\)</span>. Before we run any simulations, we may compute the standard errors of the mean, given a sample size, n, analytically, using the formula: <span class="math inline">\(\sigma_{\bar{x}}= \frac{\sigma}{\sqrt{n}}\)</span>.</p>
<pre class="r"><code># sd of the distribution of a random sample n=5
sd_5 &lt;- sqrt(lambda) / sqrt(5)
# sd of the distribution of a random sample n=15
sd_15 &lt;- sqrt(lambda) / sqrt(15)
# sd of the distribution of a random sample n=30
sd_30 &lt;- sqrt(lambda) / sqrt(30)
# sd of the distribution of a random sample n=100
sd_100 &lt;- sqrt(lambda) / sqrt(100)
# sd of the distribution of a random sample n=200
sd_200 &lt;- sqrt(lambda) / sqrt(200)
# store in one vector
se &lt;- c(sd_5, sd_15, sd_30, sd_100, sd_200)
names(se) &lt;- c(&quot;5&quot;, &quot;15&quot;, &quot;30&quot;, &quot;100&quot;, &quot;200&quot;)
se</code></pre>
<pre><code>        5        15        30       100       200 
1.3540064 0.7817360 0.5527708 0.3027650 0.2140872 </code></pre>
<p>Here, we see that our simulated values match pretty well with our analytical solutions.</p>
</div>
<div id="multivariate-normal-distribution" class="section level2">
<h2>Multivariate Normal Distribution</h2>
<p>When two random variables <span class="math inline">\(X_{1}\)</span> and <span class="math inline">\(X_{2}\)</span> have a bivariate normal distribution, we can express them using matrix notations.</p>
<p>A random <span class="math inline">\(2 \times 1\)</span> column vector X and its mean:</p>
<p><span class="math display">\[\begin{align*}
X &amp;= \begin{pmatrix} X_{1}\\ X_{2} \end{pmatrix} \\
\mu &amp;= \begin{pmatrix} \mu_{X_{1}}\\ \mu_{X_{2}} \end{pmatrix}
\end{align*}\]</span></p>
<p>A <span class="math inline">\(2 \times 2\)</span> covariance matrix:</p>
<p><span class="math display">\[\begin{align*}
\sum &amp;= \begin{pmatrix} Var_{X_{1}} &amp; Cov_{X_{2}X_{1}}\\ Cov_{X_{1}X_{2}} &amp; Var_{X_{2}} \end{pmatrix} \\
     &amp;= \begin{pmatrix} \sigma^2_{X_{1}} &amp; \rho\cdot\sigma_{X_{2}}\cdot\sigma_{X_{1}} \\ \rho\cdot \sigma_{X_{1}}\cdot\sigma_{X_{2}} &amp; \sigma^2_{X_{2}} \end{pmatrix}
\end{align*}\]</span></p>
<p>Then, we say <span class="math inline">\(X \sim N(\mu,\sum)\)</span>. From Horton’s code, we have the following user-defined function:</p>
<pre class="r"><code># Define a function for genearting random multivariate normals
rmultnorm &lt;- function(n, mu, vmat, tol = 1e-07) {
  p &lt;- ncol(vmat)
  if (length(mu) != p) {
    stop(&quot;alright, alright, alright, mu vector is the wrong length&quot;)
  }
  if (max(abs(vmat - t(vmat))) &gt; tol) {
    stop(&quot;vmat not symmetric&quot;)
  }
  vs &lt;- svd(vmat)
  vsqrt &lt;- t(vs$v %*% (t(vs$u) * sqrt(vs$d)))
  ans &lt;- matrix(rnorm(n * p), nrow = n) %*% vsqrt
  ans &lt;- sweep(ans, 2, mu, &quot;+&quot;)
  dimnames(ans) &lt;- list(NULL, dimnames(vmat)[[2]])
  return(ans)
}</code></pre>
<p>We now have a function for genearting random multivariate normals. If we would like simulate observations from a bivariate normal distribution with mean 100, variance 14, and <em>moderate</em> negative association, and we use the Cohen (1988) convention for interpreting the strength of the correlation coefficient, we need to find <span class="math inline">\(X_{1}\)</span> and <span class="math inline">\(X_{2}\)</span> with a correlation coefficient, <span class="math inline">\(\rho\)</span>, of <span class="math inline">\(\approx\)</span> -0.3:</p>
<p><span class="math display">\[\begin{align*}
\frac{Cov_{X_{1}X_{2}}}{\sigma_{X_{1}}\sigma_{X_{2}}}&amp;=-0.3\\
Cov_{X_{1}X_{2}}&amp;=\sigma_{X_{1}}\sigma_{X_{2}}\cdot(-0.3)\\
Cov_{X_{1}X_{2}}&amp;=-0.3\sqrt{14}\sqrt{14}\\
Cov_{X_{1}X_{2}}&amp;\approx-4.2
\end{align*}\]</span></p>
<p>We modify the inputs of the function defined above:</p>
<pre class="r"><code># Sample size
n &lt;- 100
# Mean Vector
mean &lt;- c(100, 100)
# Variance
var_1 &lt;- 14
var_2 &lt;- var_1
# Covariance
cov &lt;- -0.3 * sqrt(14) * sqrt(14)
# Generate two normal random variables with rho = -0.3
set.seed(12)
moderate_negative &lt;- rmultnorm(n, mean, matrix(c(var_1, cov, cov, var_2), nrow = 2))</code></pre>
<p>Here is a scatter plot on the xy-plane:</p>
<pre class="r"><code># Using ggplot()
p &lt;- ggplot(data = data.frame(moderate_negative), aes(
  x = moderate_negative[, 1],
  y = moderate_negative[, 2]
))
p &lt;- p + geom_point(color = &quot;orange&quot;)
p &lt;- p + xlim(c(86, 115)) + ylim(c(88, 112))
p &lt;- p + ggtitle(&quot;Scatter Plot of Bivariate Normal Random Variables
                 with Moderate Negative Association (rho = -0.24)&quot;)
p &lt;- p + xlab(&quot;X1&quot;) + ylab(&quot;X2&quot;)
p &lt;- p + theme(panel.background = element_rect(fill = &quot;azure2&quot;))
p</code></pre>
<p><img src="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Here’s a 3D plot of the joint probability density function of the two random variables:</p>
<pre class="r"><code># Bandwidth
# Using a rule-of-thumb for choosing the bandwidth of a Gaussian kernel density estimator
bw_vector &lt;- c(bandwidth.nrd(moderate_negative[, 1]), bandwidth.nrd(moderate_negative[, 2]))
bw_moderate_negative &lt;- mean(bw_vector)
# Using the kde2d() function from the MASS package
# kde2d() is used for 2d kernel density estimation
joint_pdf &lt;- kde2d(x = moderate_negative[, 1], y = moderate_negative[, 2], h = bw_moderate_negative)
# Using plot_ly() from the plotly graphics library
# the pipe operator %&gt;% will forward the result of an expression into the next function call
joint_pdf2d &lt;- plot_ly(x = joint_pdf$x, y = joint_pdf$y, z = joint_pdf$z)
joint_pdf2d &lt;- joint_pdf2d %&gt;% layout(title = &quot;Bivariate Density (rho = -0.29)&quot;)
joint_pdf2d &lt;- joint_pdf2d %&gt;% add_surface()
joint_pdf2d</code></pre>
<div id="htmlwidget-1" style="width:576px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"13f1126d48fa":["function () ","plotlyVisDat"]},"cur_data":"13f1126d48fa","attrs":{"13f1126d48fa":{"x":[91.1225845792483,91.8159946067567,92.5094046342652,93.2028146617736,93.8962246892821,94.5896347167905,95.283044744299,95.9764547718074,96.6698647993159,97.3632748268243,98.0566848543328,98.7500948818412,99.4435049093497,100.136914936858,100.830324964367,101.523734991875,102.217145019383,102.910555046892,103.6039650744,104.297375101909,104.990785129417,105.684195156926,106.377605184434,107.071015211943,107.764425239451],"y":[92.9673324212696,93.5922905492131,94.2172486771566,94.8422068051002,95.4671649330437,96.0921230609872,96.7170811889308,97.3420393168743,97.9669974448178,98.5919555727614,99.2169137007049,99.8418718286484,100.466829956592,101.091788084535,101.716746212479,102.341704340423,102.966662468366,103.59162059631,104.216578724253,104.841536852197,105.46649498014,106.091453108084,106.716411236027,107.341369363971,107.966327491914],"z":[[1.87011334411545e-06,2.39103948308038e-06,3.09355817870029e-06,4.20287894859379e-06,5.97683293869588e-06,8.75797484293117e-06,1.33022742052132e-05,2.17830463865876e-05,3.97229393077791e-05,7.73939186044429e-05,0.000146521071133156,0.000249180019212858,0.000364911760714294,0.000451891196940173,0.000471017404224172,0.000417182420569302,0.0003290814515624,0.000268948106008751,0.000291686994746042,0.000423078810626483,0.000647681680409775,0.000903714632905289,0.00109660701196013,0.00114135973147392,0.00101337490903684],[9.02250985979411e-06,1.13793404169283e-05,1.44116941284174e-05,1.90523733681906e-05,2.62015441498829e-05,3.65381851853952e-05,5.06424700211677e-05,7.00429027098206e-05,0.00010019266074852,0.000153773400769353,0.000247602013931228,0.000387129095410334,0.000546558336914926,0.000668445012157964,0.000697261636159005,0.000624881549104817,0.000505427729983345,0.000425038906435183,0.000454821847700905,0.000619663122231587,0.000888727643628531,0.00118086071428972,0.00138815536767879,0.00142145110503088,0.00125851326471792],[3.50901121985418e-05,4.37544716762594e-05,5.43694941879922e-05,7.01259937507076e-05,9.38054829614379e-05,0.000126649857919798,0.000167506742583469,0.00021295636017687,0.000261530662023761,0.000321704101928853,0.000413401858558368,0.00055110894476914,0.000716089463627292,0.000849201023852298,0.000886827539107952,0.00081625791405419,0.00069718860987325,0.00062690344609418,0.000681564571863745,0.000878224244934674,0.00117042600494385,0.00146568985394287,0.0016562526567515,0.00166037272615788,0.00146141154447764],[0.000110386704337733,0.000136432342588468,0.00016673892279024,0.00021022482218276,0.000274203650571324,0.000360732092527133,0.000463530004018578,0.000565734820590972,0.000646171745781653,0.000697717820169826,0.000741526365296987,0.000813014061306095,0.000922546736463707,0.00103116703174935,0.0010776229124048,0.00103872445134119,0.000962065971745845,0.000935908611753339,0.00102612235072696,0.0012357379271868,0.0015082316523355,0.00175509406718307,0.00188550447124127,0.00183497518446083,0.00159344797680931],[0.000282271349787745,0.000346881157040786,0.000418113647142235,0.000516229281405287,0.000657391044436295,0.000844797191004771,0.00106199192427942,0.001266918244565,0.00140213506129521,0.00143204726715937,0.001380288795644,0.00132122955655319,0.00132017933664458,0.00137764648301089,0.0014377216682186,0.00145429080417838,0.00144386608098416,0.00146875464546744,0.00157356498659352,0.00174489925452883,0.00192530219719534,0.00204861934735179,0.00205883308828067,0.00191756463615695,0.0016214584977227],[0.000591016634510215,0.000725075662729436,0.000864981802476532,0.00104790819092238,0.00130390196005485,0.00163854193745999,0.00202131261583164,0.0023750140599892,0.00259221830740394,0.00259983313477515,0.0024285414992727,0.00220897230300517,0.00207946677974861,0.00208615583248479,0.00217001040426957,0.00224673965297074,0.00228936437232589,0.00232834205159719,0.00238627426521963,0.00243739748398448,0.00243399341652674,0.00234809227630777,0.00217279284563039,0.00190276919726711,0.00154085614433158],[0.00102458459236045,0.00126203261220834,0.00149728291956262,0.00178457366825613,0.00217109356755748,0.00266913831634063,0.00323724700198982,0.00376278071861784,0.00408509392948947,0.00409179785661598,0.00382381558880089,0.00347302851821725,0.00324977087492117,0.00323554358286649,0.00335470317947528,0.00347647005038331,0.00352954961240491,0.00351623768733637,0.00344352204880993,0.0032829317681945,0.00300851590228608,0.00264164992945169,0.00223199503547275,0.00180980875227289,0.00138136690118761],[0.00149687584204009,0.00186685798750663,0.00221852575710951,0.00261185452724667,0.00310936015102939,0.00373963962913605,0.00446580789868289,0.00515407821725739,0.00559969753956605,0.00565370213673833,0.00536223942377539,0.00496410924115754,0.00472008093501347,0.00472710854292219,0.00488534801830522,0.00502389794218815,0.00503797924425597,0.00490893640889358,0.00463429999185263,0.0041931327855555,0.00359270545144297,0.00290987015604872,0.00225074077678257,0.00167784435360889,0.00119523686857418],[0.00189603434362354,0.00242351568365005,0.00291449694471216,0.00340999413929136,0.00397825236597954,0.004677670316874,0.00550337307112638,0.00632704740438619,0.00691574866743407,0.00708412805562546,0.00686638796635438,0.00651832647065865,0.00632068751666932,0.00636949220288652,0.00654556681988226,0.00665697039859458,0.00658347140971427,0.0062946652492409,0.00578410109479652,0.00504554148062816,0.00412410263843703,0.00314811661721372,0.00226976775565565,0.00157376504745076,0.00105513155334387],[0.00217262918386838,0.00288664419437683,0.00355379067202752,0.00416359519381571,0.00477220982811543,0.00547872488005511,0.00634132248994623,0.00726936493299941,0.00801966789569586,0.00836578469901739,0.0083029820456058,0.00806743064883594,0.00793332710069597,0.00799213759537864,0.0081218851773215,0.00813329215791915,0.0079109305810746,0.00742776333571041,0.00668500778587716,0.00569577931275299,0.00453406293725154,0.00335756845265364,0.00233961944332525,0.00157045234296848,0.00103175012989031],[0.00236999283549946,0.0032994004457189,0.00418412983626856,0.00493489823431805,0.00557455573745505,0.00624337970630743,0.00708450881364446,0.00807546518359225,0.00898475009854803,0.00954337481791338,0.00968007508682349,0.00957391801984507,0.00947033846621183,0.00946124460940762,0.00944456141780364,0.00925844200162158,0.00881433269938848,0.00811065195201446,0.00717375372612907,0.00603563270095524,0.00477396993514846,0.00353627255004935,0.00248263040721494,0.0016932567864427,0.00114074738461662],[0.00255648281745146,0.00369583034117764,0.0047977157806274,0.00568980205448956,0.00634984373869069,0.0069476643885302,0.00771193544075069,0.00870677452534699,0.00973850517366604,0.010507834221654,0.0108614658188879,0.0108878859862303,0.0107784662121675,0.010626209836945,0.0103709589443817,0.00990646321778126,0.00919712773796003,0.00828843010124306,0.00724091568721884,0.00609071858363926,0.00488151395662591,0.00370790816817359,0.00269083947451908,0.00190057668867476,0.001319512531313],[0.00274296397193584,0.00401164464287966,0.00523869212665418,0.0062008573210402,0.0068432294911037,0.00734770882718321,0.00800112315029332,0.00894625829014939,0.0100462598714747,0.0109970167522618,0.0115696002277998,0.0117434550704982,0.0116302631334982,0.011314342785821,0.0107912866457027,0.0100373750782781,0.00909383304176792,0.00806249491221437,0.00702759316288337,0.00600082855068426,0.00495595654997507,0.00390807821184538,0.00293483284263437,0.00211551302672175,0.00147141959193188],[0.00288134250412659,0.00413234560400425,0.00531584059227615,0.00621902958627432,0.00679044519474177,0.00720684247376342,0.0077613602212396,0.00863458029761061,0.00974523058669457,0.0108147482322802,0.0115714985926756,0.0118983386825477,0.0118179464789621,0.0113913760488151,0.0106657590861049,0.00970567928985203,0.00863194199804296,0.00759256029212062,0.00667528267658922,0.00584851105690073,0.00500702100315701,0.00408811625229436,0.00313640235703505,0.00225707541322147,0.00152894235948206],[0.00292487957596522,0.00402066451321897,0.00501210033827424,0.00575545358454852,0.00623764842581557,0.00661109138936076,0.00711358681021209,0.0079037403549372,0.00893798074151837,0.00999574604503774,0.0108222984001817,0.0112551531791753,0.0112465802183456,0.0108197780638033,0.0100415984042084,0.00903064415550463,0.00795597253978282,0.0069869839387191,0.00620634629246545,0.00555530104291846,0.00488328525035029,0.0040787754853971,0.00316091151854623,0.00225071297174376,0.0014720772198086],[0.00286499415006566,0.00375569145935151,0.00452227834572062,0.00511240139336093,0.00555684851328508,0.00595920860544255,0.00645198542167769,0.00712119766552948,0.00794285019223999,0.00878796932431601,0.00949246486325,0.00992430627681423,0.0100032542452852,0.00969873231636636,0.00904211921970225,0.00814111297143075,0.00716266004032553,0.00627440890738531,0.00556451125355157,0.00499059152472352,0.00441528335173782,0.0037190835805533,0.00289574153606871,0.00204839476877073,0.00130687859593374],[0.00271633129615889,0.00344117506376342,0.00405950070522879,0.00459156686876367,0.00508757249956234,0.00558214558585674,0.00608412526755575,0.00658634474809407,0.00707297210030935,0.00752538835450611,0.00792419411144824,0.00823298335858312,0.00837740848021732,0.00826233626587149,0.00783351349925603,0.00713026971936235,0.00628062456206634,0.00544251675763149,0.00472598866711319,0.00413962549214836,0.00360160937275582,0.00301530612052606,0.00235037940778531,0.00166369258487644,0.00105256576397318],[0.00248421953084787,0.00310136398170855,0.00365874294598314,0.00421379923216339,0.00480894063869362,0.00541205562400623,0.0059297890192653,0.00627340962976466,0.00642334700567878,0.00645135145795684,0.0064792461057872,0.00658642018392851,0.00673207723961198,0.0067694729549068,0.00655056968735544,0.0060306552552093,0.00529162301402639,0.00448439941673381,0.00374431454385972,0.00313091775661677,0.00262007041320964,0.00214651355594671,0.00166443403885472,0.00118228153010148,0.000750233936825724],[0.00215286698383106,0.00267871631491649,0.00319267109857742,0.00376205700339877,0.00441364032294727,0.0050776873304962,0.00560967325064784,0.00587287081448873,0.00582939597131291,0.00558295724245398,0.00533050219057751,0.00523336075002997,0.00529744336279478,0.00536791749663989,0.00524812482451166,0.0048385543456765,0.00418676941314704,0.00343423032477944,0.00272503106758463,0.00214193779117687,0.00169238303706245,0.001334061325391,0.00101791623282433,0.000722796695800565,0.000461305153063027],[0.00171566362953023,0.00213101356457451,0.00256311838862125,0.003074579615084,0.0036833263592779,0.00431929304556425,0.00484232528646507,0.00510983252953663,0.00506102192201451,0.00477076029503512,0.00442228481627392,0.004192726698998,0.0041280691506385,0.00411477834195754,0.00397645995589488,0.00360886322264827,0.00304105032540076,0.00239348277883805,0.00179281872166766,0.0013132990500131,0.000966205178973438,0.000720426962068635,0.000532990548595361,0.000374762099918213,0.000239571033384792],[0.00122357228127691,0.00152196621095253,0.00184857906824881,0.00225131801363966,0.00274228530301803,0.00327139006309774,0.00373789359293946,0.00403047895570707,0.00408220500844907,0.00391634973111974,0.00364427242973667,0.00339690788784358,0.00323179358917424,0.00309531513432146,0.00287809884159909,0.00251294510777295,0.00202672467691848,0.00151169795352123,0.00105943364182158,0.000717226964129065,0.000485327511058247,0.000336430496807846,0.000237132970714683,0.000162924677049895,0.000103472858738945],[0.000782414578502858,0.000998010894368245,0.00125044838385874,0.00156364752946556,0.0019352694894436,0.00233004976852847,0.00269163446249268,0.00296051301423946,0.00309409104363937,0.00308634145414701,0.00297315932183384,0.00280921159086737,0.00262599636920634,0.00240788013345982,0.00211495956334445,0.00173413810628595,0.00130603877027568,0.000901910152660608,0.000578709371518447,0.000354723088334626,0.00021610925572305,0.00013603036634207,8.930651305618e-05,5.89414543566549e-05,3.67919457213681e-05],[0.000480205655323605,0.000668344461051084,0.00090773562744362,0.00119350148807351,0.00149733536986268,0.0017808841111405,0.00201637832615091,0.00219566469855013,0.00232327891456157,0.00240278560979424,0.00242817966461155,0.00238478557100195,0.00225466608142535,0.00202349332780952,0.00169346183675693,0.00129814517960626,0.000899972691563504,0.000562681417728649,0.000320665652161062,0.000171228655855429,8.97634442190927e-05,4.89367935548397e-05,2.87371915335802e-05,1.77310924829687e-05,1.07149975641974e-05],[0.000322747301802389,0.00051938421565177,0.00078320589792828,0.00108459739349008,0.00136778686203278,0.00157986585707457,0.00170279271041875,0.00176353797990375,0.00181322504571895,0.00188696726216186,0.00197304338331036,0.00201690417511176,0.00195613692352463,0.00175803960059682,0.00143807478228361,0.00105513355471763,0.000686626131028592,0.000394053090961356,0.000200140689499709,9.16377290281987e-05,3.94765328724076e-05,1.72472848505869e-05,8.31678588055811e-06,4.51511177385327e-06,2.56264794419386e-06],[0.000247986986089118,0.000448816909610532,0.000723611494149579,0.00103014555769676,0.00129781071400225,0.00146330860651205,0.00150854700214513,0.00147412508719009,0.0014359446668045,0.00145428505576341,0.00152890797743422,0.00159739335236103,0.0015792680838984,0.0014288875392946,0.00115992779488708,0.000833615484424724,0.000524839434264461,0.000287187602884249,0.000136092390796634,5.60959276611541e-05,2.05210374480404e-05,7.02566546930307e-06,2.50530699978789e-06,1.04987897193029e-06,5.16034402361683e-07]],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Bivariate Density (rho = -0.29)","scene":{"xaxis":{"title":[]},"yaxis":{"title":[]},"zaxis":{"title":[]}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[91.1225845792483,91.8159946067567,92.5094046342652,93.2028146617736,93.8962246892821,94.5896347167905,95.283044744299,95.9764547718074,96.6698647993159,97.3632748268243,98.0566848543328,98.7500948818412,99.4435049093497,100.136914936858,100.830324964367,101.523734991875,102.217145019383,102.910555046892,103.6039650744,104.297375101909,104.990785129417,105.684195156926,106.377605184434,107.071015211943,107.764425239451],"y":[92.9673324212696,93.5922905492131,94.2172486771566,94.8422068051002,95.4671649330437,96.0921230609872,96.7170811889308,97.3420393168743,97.9669974448178,98.5919555727614,99.2169137007049,99.8418718286484,100.466829956592,101.091788084535,101.716746212479,102.341704340423,102.966662468366,103.59162059631,104.216578724253,104.841536852197,105.46649498014,106.091453108084,106.716411236027,107.341369363971,107.966327491914],"z":[[1.87011334411545e-06,2.39103948308038e-06,3.09355817870029e-06,4.20287894859379e-06,5.97683293869588e-06,8.75797484293117e-06,1.33022742052132e-05,2.17830463865876e-05,3.97229393077791e-05,7.73939186044429e-05,0.000146521071133156,0.000249180019212858,0.000364911760714294,0.000451891196940173,0.000471017404224172,0.000417182420569302,0.0003290814515624,0.000268948106008751,0.000291686994746042,0.000423078810626483,0.000647681680409775,0.000903714632905289,0.00109660701196013,0.00114135973147392,0.00101337490903684],[9.02250985979411e-06,1.13793404169283e-05,1.44116941284174e-05,1.90523733681906e-05,2.62015441498829e-05,3.65381851853952e-05,5.06424700211677e-05,7.00429027098206e-05,0.00010019266074852,0.000153773400769353,0.000247602013931228,0.000387129095410334,0.000546558336914926,0.000668445012157964,0.000697261636159005,0.000624881549104817,0.000505427729983345,0.000425038906435183,0.000454821847700905,0.000619663122231587,0.000888727643628531,0.00118086071428972,0.00138815536767879,0.00142145110503088,0.00125851326471792],[3.50901121985418e-05,4.37544716762594e-05,5.43694941879922e-05,7.01259937507076e-05,9.38054829614379e-05,0.000126649857919798,0.000167506742583469,0.00021295636017687,0.000261530662023761,0.000321704101928853,0.000413401858558368,0.00055110894476914,0.000716089463627292,0.000849201023852298,0.000886827539107952,0.00081625791405419,0.00069718860987325,0.00062690344609418,0.000681564571863745,0.000878224244934674,0.00117042600494385,0.00146568985394287,0.0016562526567515,0.00166037272615788,0.00146141154447764],[0.000110386704337733,0.000136432342588468,0.00016673892279024,0.00021022482218276,0.000274203650571324,0.000360732092527133,0.000463530004018578,0.000565734820590972,0.000646171745781653,0.000697717820169826,0.000741526365296987,0.000813014061306095,0.000922546736463707,0.00103116703174935,0.0010776229124048,0.00103872445134119,0.000962065971745845,0.000935908611753339,0.00102612235072696,0.0012357379271868,0.0015082316523355,0.00175509406718307,0.00188550447124127,0.00183497518446083,0.00159344797680931],[0.000282271349787745,0.000346881157040786,0.000418113647142235,0.000516229281405287,0.000657391044436295,0.000844797191004771,0.00106199192427942,0.001266918244565,0.00140213506129521,0.00143204726715937,0.001380288795644,0.00132122955655319,0.00132017933664458,0.00137764648301089,0.0014377216682186,0.00145429080417838,0.00144386608098416,0.00146875464546744,0.00157356498659352,0.00174489925452883,0.00192530219719534,0.00204861934735179,0.00205883308828067,0.00191756463615695,0.0016214584977227],[0.000591016634510215,0.000725075662729436,0.000864981802476532,0.00104790819092238,0.00130390196005485,0.00163854193745999,0.00202131261583164,0.0023750140599892,0.00259221830740394,0.00259983313477515,0.0024285414992727,0.00220897230300517,0.00207946677974861,0.00208615583248479,0.00217001040426957,0.00224673965297074,0.00228936437232589,0.00232834205159719,0.00238627426521963,0.00243739748398448,0.00243399341652674,0.00234809227630777,0.00217279284563039,0.00190276919726711,0.00154085614433158],[0.00102458459236045,0.00126203261220834,0.00149728291956262,0.00178457366825613,0.00217109356755748,0.00266913831634063,0.00323724700198982,0.00376278071861784,0.00408509392948947,0.00409179785661598,0.00382381558880089,0.00347302851821725,0.00324977087492117,0.00323554358286649,0.00335470317947528,0.00347647005038331,0.00352954961240491,0.00351623768733637,0.00344352204880993,0.0032829317681945,0.00300851590228608,0.00264164992945169,0.00223199503547275,0.00180980875227289,0.00138136690118761],[0.00149687584204009,0.00186685798750663,0.00221852575710951,0.00261185452724667,0.00310936015102939,0.00373963962913605,0.00446580789868289,0.00515407821725739,0.00559969753956605,0.00565370213673833,0.00536223942377539,0.00496410924115754,0.00472008093501347,0.00472710854292219,0.00488534801830522,0.00502389794218815,0.00503797924425597,0.00490893640889358,0.00463429999185263,0.0041931327855555,0.00359270545144297,0.00290987015604872,0.00225074077678257,0.00167784435360889,0.00119523686857418],[0.00189603434362354,0.00242351568365005,0.00291449694471216,0.00340999413929136,0.00397825236597954,0.004677670316874,0.00550337307112638,0.00632704740438619,0.00691574866743407,0.00708412805562546,0.00686638796635438,0.00651832647065865,0.00632068751666932,0.00636949220288652,0.00654556681988226,0.00665697039859458,0.00658347140971427,0.0062946652492409,0.00578410109479652,0.00504554148062816,0.00412410263843703,0.00314811661721372,0.00226976775565565,0.00157376504745076,0.00105513155334387],[0.00217262918386838,0.00288664419437683,0.00355379067202752,0.00416359519381571,0.00477220982811543,0.00547872488005511,0.00634132248994623,0.00726936493299941,0.00801966789569586,0.00836578469901739,0.0083029820456058,0.00806743064883594,0.00793332710069597,0.00799213759537864,0.0081218851773215,0.00813329215791915,0.0079109305810746,0.00742776333571041,0.00668500778587716,0.00569577931275299,0.00453406293725154,0.00335756845265364,0.00233961944332525,0.00157045234296848,0.00103175012989031],[0.00236999283549946,0.0032994004457189,0.00418412983626856,0.00493489823431805,0.00557455573745505,0.00624337970630743,0.00708450881364446,0.00807546518359225,0.00898475009854803,0.00954337481791338,0.00968007508682349,0.00957391801984507,0.00947033846621183,0.00946124460940762,0.00944456141780364,0.00925844200162158,0.00881433269938848,0.00811065195201446,0.00717375372612907,0.00603563270095524,0.00477396993514846,0.00353627255004935,0.00248263040721494,0.0016932567864427,0.00114074738461662],[0.00255648281745146,0.00369583034117764,0.0047977157806274,0.00568980205448956,0.00634984373869069,0.0069476643885302,0.00771193544075069,0.00870677452534699,0.00973850517366604,0.010507834221654,0.0108614658188879,0.0108878859862303,0.0107784662121675,0.010626209836945,0.0103709589443817,0.00990646321778126,0.00919712773796003,0.00828843010124306,0.00724091568721884,0.00609071858363926,0.00488151395662591,0.00370790816817359,0.00269083947451908,0.00190057668867476,0.001319512531313],[0.00274296397193584,0.00401164464287966,0.00523869212665418,0.0062008573210402,0.0068432294911037,0.00734770882718321,0.00800112315029332,0.00894625829014939,0.0100462598714747,0.0109970167522618,0.0115696002277998,0.0117434550704982,0.0116302631334982,0.011314342785821,0.0107912866457027,0.0100373750782781,0.00909383304176792,0.00806249491221437,0.00702759316288337,0.00600082855068426,0.00495595654997507,0.00390807821184538,0.00293483284263437,0.00211551302672175,0.00147141959193188],[0.00288134250412659,0.00413234560400425,0.00531584059227615,0.00621902958627432,0.00679044519474177,0.00720684247376342,0.0077613602212396,0.00863458029761061,0.00974523058669457,0.0108147482322802,0.0115714985926756,0.0118983386825477,0.0118179464789621,0.0113913760488151,0.0106657590861049,0.00970567928985203,0.00863194199804296,0.00759256029212062,0.00667528267658922,0.00584851105690073,0.00500702100315701,0.00408811625229436,0.00313640235703505,0.00225707541322147,0.00152894235948206],[0.00292487957596522,0.00402066451321897,0.00501210033827424,0.00575545358454852,0.00623764842581557,0.00661109138936076,0.00711358681021209,0.0079037403549372,0.00893798074151837,0.00999574604503774,0.0108222984001817,0.0112551531791753,0.0112465802183456,0.0108197780638033,0.0100415984042084,0.00903064415550463,0.00795597253978282,0.0069869839387191,0.00620634629246545,0.00555530104291846,0.00488328525035029,0.0040787754853971,0.00316091151854623,0.00225071297174376,0.0014720772198086],[0.00286499415006566,0.00375569145935151,0.00452227834572062,0.00511240139336093,0.00555684851328508,0.00595920860544255,0.00645198542167769,0.00712119766552948,0.00794285019223999,0.00878796932431601,0.00949246486325,0.00992430627681423,0.0100032542452852,0.00969873231636636,0.00904211921970225,0.00814111297143075,0.00716266004032553,0.00627440890738531,0.00556451125355157,0.00499059152472352,0.00441528335173782,0.0037190835805533,0.00289574153606871,0.00204839476877073,0.00130687859593374],[0.00271633129615889,0.00344117506376342,0.00405950070522879,0.00459156686876367,0.00508757249956234,0.00558214558585674,0.00608412526755575,0.00658634474809407,0.00707297210030935,0.00752538835450611,0.00792419411144824,0.00823298335858312,0.00837740848021732,0.00826233626587149,0.00783351349925603,0.00713026971936235,0.00628062456206634,0.00544251675763149,0.00472598866711319,0.00413962549214836,0.00360160937275582,0.00301530612052606,0.00235037940778531,0.00166369258487644,0.00105256576397318],[0.00248421953084787,0.00310136398170855,0.00365874294598314,0.00421379923216339,0.00480894063869362,0.00541205562400623,0.0059297890192653,0.00627340962976466,0.00642334700567878,0.00645135145795684,0.0064792461057872,0.00658642018392851,0.00673207723961198,0.0067694729549068,0.00655056968735544,0.0060306552552093,0.00529162301402639,0.00448439941673381,0.00374431454385972,0.00313091775661677,0.00262007041320964,0.00214651355594671,0.00166443403885472,0.00118228153010148,0.000750233936825724],[0.00215286698383106,0.00267871631491649,0.00319267109857742,0.00376205700339877,0.00441364032294727,0.0050776873304962,0.00560967325064784,0.00587287081448873,0.00582939597131291,0.00558295724245398,0.00533050219057751,0.00523336075002997,0.00529744336279478,0.00536791749663989,0.00524812482451166,0.0048385543456765,0.00418676941314704,0.00343423032477944,0.00272503106758463,0.00214193779117687,0.00169238303706245,0.001334061325391,0.00101791623282433,0.000722796695800565,0.000461305153063027],[0.00171566362953023,0.00213101356457451,0.00256311838862125,0.003074579615084,0.0036833263592779,0.00431929304556425,0.00484232528646507,0.00510983252953663,0.00506102192201451,0.00477076029503512,0.00442228481627392,0.004192726698998,0.0041280691506385,0.00411477834195754,0.00397645995589488,0.00360886322264827,0.00304105032540076,0.00239348277883805,0.00179281872166766,0.0013132990500131,0.000966205178973438,0.000720426962068635,0.000532990548595361,0.000374762099918213,0.000239571033384792],[0.00122357228127691,0.00152196621095253,0.00184857906824881,0.00225131801363966,0.00274228530301803,0.00327139006309774,0.00373789359293946,0.00403047895570707,0.00408220500844907,0.00391634973111974,0.00364427242973667,0.00339690788784358,0.00323179358917424,0.00309531513432146,0.00287809884159909,0.00251294510777295,0.00202672467691848,0.00151169795352123,0.00105943364182158,0.000717226964129065,0.000485327511058247,0.000336430496807846,0.000237132970714683,0.000162924677049895,0.000103472858738945],[0.000782414578502858,0.000998010894368245,0.00125044838385874,0.00156364752946556,0.0019352694894436,0.00233004976852847,0.00269163446249268,0.00296051301423946,0.00309409104363937,0.00308634145414701,0.00297315932183384,0.00280921159086737,0.00262599636920634,0.00240788013345982,0.00211495956334445,0.00173413810628595,0.00130603877027568,0.000901910152660608,0.000578709371518447,0.000354723088334626,0.00021610925572305,0.00013603036634207,8.930651305618e-05,5.89414543566549e-05,3.67919457213681e-05],[0.000480205655323605,0.000668344461051084,0.00090773562744362,0.00119350148807351,0.00149733536986268,0.0017808841111405,0.00201637832615091,0.00219566469855013,0.00232327891456157,0.00240278560979424,0.00242817966461155,0.00238478557100195,0.00225466608142535,0.00202349332780952,0.00169346183675693,0.00129814517960626,0.000899972691563504,0.000562681417728649,0.000320665652161062,0.000171228655855429,8.97634442190927e-05,4.89367935548397e-05,2.87371915335802e-05,1.77310924829687e-05,1.07149975641974e-05],[0.000322747301802389,0.00051938421565177,0.00078320589792828,0.00108459739349008,0.00136778686203278,0.00157986585707457,0.00170279271041875,0.00176353797990375,0.00181322504571895,0.00188696726216186,0.00197304338331036,0.00201690417511176,0.00195613692352463,0.00175803960059682,0.00143807478228361,0.00105513355471763,0.000686626131028592,0.000394053090961356,0.000200140689499709,9.16377290281987e-05,3.94765328724076e-05,1.72472848505869e-05,8.31678588055811e-06,4.51511177385327e-06,2.56264794419386e-06],[0.000247986986089118,0.000448816909610532,0.000723611494149579,0.00103014555769676,0.00129781071400225,0.00146330860651205,0.00150854700214513,0.00147412508719009,0.0014359446668045,0.00145428505576341,0.00152890797743422,0.00159739335236103,0.0015792680838984,0.0014288875392946,0.00115992779488708,0.000833615484424724,0.000524839434264461,0.000287187602884249,0.000136092390796634,5.60959276611541e-05,2.05210374480404e-05,7.02566546930307e-06,2.50530699978789e-06,1.04987897193029e-06,5.16034402361683e-07]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>As can be seen, when <span class="math inline">\(\rho\)</span> is negative, the bell-shaped surface becomes flattened on a negative sloping line extending out towards the top left and bottom right corners. So for <span class="math inline">\(\rho \approx -0.29\)</span>, X1 varies negatively with X2 (X2 is denoted as Y in the figure).</p>
<p>To simulate observations from a bivariate normal distribution with a <em>strong</em> negative association, say, <span class="math inline">\(\rho = -0.8\)</span>, we again modify the inputs to the function we defined in the begining. Here are the scatter plot and the plot of their joint probability function:</p>
<pre class="r"><code># Using ggplot()
p &lt;- ggplot(data = data.frame(strong_negative), aes(
  x = strong_negative[, 1],
  y = strong_negative[, 2]
))
p &lt;- p + geom_point(color = &quot;orange&quot;)
p &lt;- p + xlim(c(89, 112)) + ylim(c(86, 111))
p &lt;- p + ggtitle(&quot;Scatter Plot of Bivariate Normal Random Variables
                 with Strong Negative Association (rho = -0.81)&quot;)
p &lt;- p + xlab(&quot;X1&quot;) + ylab(&quot;X2&quot;)
p &lt;- p + theme(panel.background = element_rect(fill = &quot;azure2&quot;))
p</code></pre>
<p><img src="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;" /></p>
<pre class="r"><code># Bandwidth
bw_vector &lt;- c(bandwidth.nrd(strong_negative[, 1]), bandwidth.nrd(strong_negative[, 2]))
bw_strong_negative &lt;- mean(bw_vector)
# 2d kernel density estimation
joint_pdf &lt;- kde2d(x = strong_negative[, 1], y = strong_negative[, 2], h = bw_strong_negative)
# Using plot_ly()
joint_pdf2d &lt;- plot_ly(x = joint_pdf$x, y = joint_pdf$y, z = joint_pdf$z)
joint_pdf2d &lt;- joint_pdf2d %&gt;% layout(title = &quot;Bivariate Density (rho = -0.80)&quot;)
joint_pdf2d &lt;- joint_pdf2d %&gt;% add_surface()
joint_pdf2d</code></pre>
<div id="htmlwidget-2" style="width:576px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"visdat":{"13f16a8f465e":["function () ","plotlyVisDat"]},"cur_data":"13f16a8f465e","attrs":{"13f16a8f465e":{"x":[88.9398907298665,89.8067295301701,90.6735683304737,91.5404071307773,92.4072459310809,93.2740847313845,94.1409235316881,95.0077623319917,95.8746011322953,96.7414399325989,97.6082787329024,98.475117533206,99.3419563335096,100.208795133813,101.075633934117,101.94247273442,102.809311534724,103.676150335028,104.542989135331,105.409827935635,106.276666735938,107.143505536242,108.010344336546,108.877183136849,109.744021937153],"y":[92.3004145455501,92.9920082957279,93.6836020459057,94.3751957960835,95.0667895462613,95.758383296439,96.4499770466168,97.1415707967946,97.8331645469724,98.5247582971502,99.2163520473279,99.9079457975057,100.599539547683,101.291133297861,101.982727048039,102.674320798217,103.365914548395,104.057508298572,104.74910204875,105.440695798928,106.132289549106,106.823883299284,107.515477049461,108.207070799639,108.898664549817],"z":[[6.85666889382839e-11,2.56461062778276e-10,9.14548163093976e-10,3.26626647514284e-09,1.12750183663048e-08,3.4785687172498e-08,9.07838153113766e-08,1.99001293966871e-07,3.97141310428745e-07,9.22358341739491e-07,3.02026975362924e-06,1.13066974739126e-05,3.8170877923777e-05,0.000106719835351139,0.000241828993363136,0.00044269764711603,0.000659596627729255,0.000821128669645684,0.000910306523017004,0.000998058016700087,0.00116204483952298,0.00137182421139454,0.00149162068465402,0.00140776035786185,0.00113026510110035],[1.11615835674272e-09,3.84835427750987e-09,1.19025888503256e-08,3.57462738075808e-08,1.07444931103708e-07,3.06461164075519e-07,7.68178653776298e-07,1.61731450130647e-06,2.86382881071087e-06,4.61741514587336e-06,8.34415807496569e-06,1.9876453215551e-05,5.36950913343337e-05,0.000134123762947215,0.000284001240966961,0.000497275803454737,0.000719821719970888,0.000881793499810989,0.000975332234608128,0.0010850071155523,0.00129943523477154,0.00158618751397982,0.00178751203904542,0.00175422575404816,0.00146879928618221],[1.31235745879944e-08,4.32261402658838e-08,1.21441417745742e-07,3.12211604633419e-07,7.91313402231582e-07,1.99502482158448e-06,4.68361957852786e-06,9.53946591847351e-06,1.63204364686323e-05,2.38857454313454e-05,3.29766089112879e-05,5.13729957487455e-05,9.71083187883779e-05,0.000193506430965398,0.000352718867993018,0.000554654243080187,0.000743530318951299,0.000864784960156907,0.000925570327380137,0.00100962423772967,0.00119937119482059,0.00147023418632963,0.00168166704076597,0.00168712279177908,0.00144898843411981],[1.09911343641979e-07,3.53563894903477e-07,9.39362367460101e-07,2.15980928884618e-06,4.6378730433022e-06,9.92783386768111e-06,2.09242589069714e-05,4.03802128790854e-05,6.71980432684405e-05,9.51053195858386e-05,0.000119947213858853,0.00015262569540425,0.000223046812735061,0.000363539911042556,0.000578957845443621,0.000827456482736782,0.00103394331761079,0.00113621692616736,0.00113556478222011,0.00110559076341983,0.00113213674484974,0.00122745909378559,0.0013096947547856,0.00127486819825425,0.00108474871733017],[6.5168763122664e-07,2.07253371905638e-06,5.34748710361426e-06,1.14929223889604e-05,2.172675273907e-05,3.91357716858365e-05,7.07663013794747e-05,0.000124573022267512,0.00019870514029092,0.000275248237941528,0.000335841521218775,0.00039184651856227,0.000494216542819814,0.00070237907227133,0.00103341003020348,0.00143150763374217,0.00178090129597042,0.00195990830390536,0.00191368292349384,0.00169662837575476,0.00143182272642004,0.00121082032443105,0.00103736693992751,0.000865552029230912,0.000667567909650526],[2.73464694867009e-06,8.65457543271709e-06,2.20211302176026e-05,4.56632587600797e-05,7.9662368601395e-05,0.000124449183345366,0.000188898368924797,0.000289417558050988,0.000429120264312591,0.000579483381917023,0.000702393622055255,0.00080228003400572,0.000946800193929489,0.00122574680288443,0.00168433651808754,0.00227445151669815,0.0028417149090851,0.00317240617257218,0.00311438759132685,0.00269448064291072,0.00209944463137004,0.00152463821067587,0.00105908347737357,0.000703246018178874,0.000437586623696983],[8.16989145215803e-06,2.58163915535273e-05,6.53337797583114e-05,0.000133267930326929,0.000222774367596013,0.000317081936966473,0.000412668922636484,0.000533958577489767,0.000706627554088166,0.000917066749559779,0.00112423798950584,0.00132153171526058,0.00156780323523225,0.00194920417151718,0.00251567573961144,0.00322696141195755,0.00391347487964094,0.00430484673322298,0.00418422803684917,0.00356790028782686,0.00270136612373187,0.00185967326028506,0.00118429053089977,0.000694045751741409,0.000366144417563987],[1.7705973401565e-05,5.58090498598399e-05,0.000141032375099624,0.000286211619331567,0.000470164799662055,0.000638624428175901,0.000753001902392312,0.000840711276000456,0.000974778279506381,0.00120128148570241,0.0015126142903653,0.00189326875149723,0.00235896848447161,0.00293798529019944,0.00362683365966636,0.00435112114887996,0.00493639950698799,0.00513717081088634,0.0047800730693443,0.00392830045885396,0.00286569552423162,0.0018892289160653,0.0011426007840506,0.000630569723667282,0.000309376215249178],[2.95549692713721e-05,9.11520574802817e-05,0.00022875383913956,0.000463964388847512,0.000761684129362018,0.00102533199181644,0.0011725858998501,0.00123001217495882,0.00132816027750187,0.00159405346304718,0.00206790163984292,0.00271730733745129,0.00349063722457331,0.00433357295279647,0.00516238920038595,0.00583393121027146,0.00615365433200052,0.0059444070885943,0.00516365892538808,0.0039847636763741,0.00272919051261671,0.0016770817049814,0.000937868756291197,0.000478461538355227,0.000218756974259418],[4.58799437780387e-05,0.000127371340415318,0.0003045329283728,0.000609282536610866,0.00100834278938046,0.00139126254703779,0.00165689693859952,0.00183289494648892,0.00208077882353108,0.00256415920766287,0.00332448813195212,0.00427760931685683,0.00529567801835271,0.00626933854407633,0.00708869730661971,0.00758777145001986,0.00756028692402217,0.0068782179032787,0.00561752498474101,0.00406859761261279,0.00259883381657567,0.00146730433718884,0.000738326116317373,0.000333715062783288,0.000135313571850087],[9.04307834004146e-05,0.000199978786021514,0.00041145208825048,0.000767864979242401,0.00126465397178254,0.00182903009763921,0.00238655427492837,0.00296396715964237,0.00368781267018262,0.00465306525085559,0.00580588669340734,0.00696198209263478,0.00792989261668283,0.00861357924861013,0.00899030709756365,0.00899779672166434,0.00849489561486629,0.0073848303868999,0.00577759409090739,0.00400026338986493,0.00242657035979037,0.00128377137177582,0.000592009591046872,0.000238414229292211,8.40530495290131e-05],[0.000219621096545493,0.000406718653022114,0.0007025663678406,0.00116343902194707,0.00183840071775762,0.00273060454348387,0.00381160031183083,0.00507601805508973,0.00653082969589267,0.00809523279440875,0.00953879609998321,0.0105625620978281,0.0109706572990055,0.010783563789338,0.0101810262644235,0.00931721668817131,0.0081998514382664,0.0067707951358342,0.00509037860939661,0.00339934903303321,0.00198454453574152,0.00100392578287881,0.000437806583383735,0.000163931123032876,5.251405063661e-05],[0.000487552616338708,0.000844350089539425,0.00134098609947208,0.00205350262742157,0.00309322793609741,0.00452712408236722,0.00632363115232282,0.00837318279733729,0.0105009855544983,0.0124208933370359,0.0137389391360079,0.0141082725662149,0.0134428704183162,0.0119910167609991,0.0101847910450437,0.00838366547146284,0.00672064653854754,0.0051598387391375,0.00367479409475276,0.00235003648272868,0.00131803531822095,0.000639545334411646,0.000266510244287618,9.4870630575931e-05,2.8678232923752e-05],[0.000862791917691593,0.00146032814244806,0.00225714633918541,0.00335600997585559,0.00491558180871327,0.00700804719155804,0.00951027303222967,0.0121426069631282,0.0145512662211511,0.0163178987394588,0.0169999962088472,0.0163304611938991,0.0144392788921922,0.0118377237857227,0.00914189225668659,0.00677754340068518,0.00488056942327614,0.0033939443415516,0.00222420239316539,0.00132937839875018,0.000703929464053635,0.000323849152419299,0.000128052662765595,4.3254659267416e-05,1.24157601106926e-05],[0.00120526998400815,0.00201431562788824,0.00307458016821542,0.00450621434948806,0.00648115136626639,0.00902715835194616,0.0118996491241045,0.0146714162868047,0.0168876808541337,0.0181125888921989,0.0179794919036685,0.0163899305866742,0.0136892440535825,0.0105483922761543,0.00760918988123397,0.00521725137860985,0.00342293261060348,0.00213570751851605,0.0012469600071104,0.0006671134103092,0.000319999729821679,0.000135033811544371,4.94297685407141e-05,1.55555447784646e-05,4.18302001774013e-06],[0.00139968689759105,0.00231044264006865,0.00347196125687355,0.00498466374662915,0.00699208093503516,0.00947707531869666,0.0121452294836972,0.0145428695763928,0.0162337099982018,0.0168558548572954,0.0161735944997398,0.0142403742712271,0.011492337753115,0.00856959371511669,0.00598840180332856,0.00396184923892789,0.00247106746855414,0.0014263456221857,0.000745526748746561,0.000347548702604191,0.000143482097262019,5.22842229144714e-05,1.67510580676872e-05,4.69106023748056e-06,1.1403433570134e-06],[0.00151709393267833,0.00245227226940204,0.00357487077721427,0.00492143338973997,0.00657609752632379,0.00850378476945546,0.0104575028025069,0.0120844254448121,0.0130727687045445,0.0131954965717884,0.0123490469272068,0.0106569102176895,0.00848896805852828,0.00629557095248751,0.00439467366885379,0.00289601426887205,0.00177747823854604,0.000988763394936515,0.000484064894229241,0.000204190396317799,7.3535185478648e-05,2.26488325716307e-05,6.02072713594894e-06,1.39719899526003e-06,2.85430831382039e-07],[0.00175243781679329,0.00271836303202744,0.00375981850055126,0.00483727081300309,0.00597951837672207,0.00715756825707258,0.00821283743797088,0.0089405941941086,0.00919726466523418,0.00891758610017268,0.00811431147256506,0.00691075890599943,0.00552172310932043,0.00415763779188178,0.00294997142629689,0.00195361851530932,0.00118430377600547,0.000640432714312719,0.000300827084113726,0.000120038258751629,4.00821377509778e-05,1.11223662844322e-05,2.56764985657158e-06,4.97518400751407e-07,8.21960993192181e-08],[0.00214214366471261,0.00313808682193879,0.00406745696653187,0.00485222131900009,0.00551250441933312,0.00604710669963634,0.00636978986103137,0.00638413056064758,0.00607443541312872,0.00550600568032104,0.00477952126628566,0.00399710178228299,0.00323009198618831,0.00250147688177082,0.0018161432234738,0.00120299556611057,0.000710162840905731,0.000366934913040787,0.000163393098002776,6.17768250224477e-05,1.95585587970514e-05,5.12692117215287e-06,1.10452392022524e-06,1.9505157799594e-07,2.83158615593228e-08],[0.00247038137276678,0.00339675746458354,0.00411703768025453,0.00458188714213629,0.00486118573165939,0.0049970535712664,0.00493627141581355,0.00461087647274645,0.00404184435710605,0.00335012354951096,0.00268645574434491,0.00214768638737768,0.00173372154420607,0.00137639937593574,0.00101964183992951,0.00067200307859708,0.000382908681932882,0.000186282149090324,7.70274148744226e-05,2.6986047019004e-05,7.96669193870036e-06,1.96565376966442e-06,4.01604408184758e-07,6.73822240027374e-08,9.23048965291072e-09],[0.00257641800108467,0.00330489255779684,0.00372685077589713,0.00386952913459893,0.00387554889621464,0.00382610745785675,0.00367140424274825,0.00331921597902061,0.00276022889072584,0.00210616755199578,0.00151896254288375,0.00110143829958839,0.000844032459599759,0.00066506062519795,0.000495200410754434,0.000324008925164832,0.000179275856474936,8.27138562006869e-05,3.17778464428013e-05,1.02053487631905e-05,2.75104771062703e-06,6.23231990309589e-07,1.1827767384227e-07,1.86769912018289e-08,2.43352004078936e-09],[0.00255143375431312,0.00305017012969949,0.00319217748546576,0.00307688112075409,0.00289215014672367,0.00273848438274123,0.00257296000518896,0.00229221630381501,0.00185464728489241,0.00133435333868465,0.00086643634148012,0.000543492964712101,0.000364142399470306,0.000266548356480978,0.000193399102449354,0.000124931054144076,6.78111280138756e-05,3.02587347460922e-05,1.10471029770642e-05,3.30985074146116e-06,8.1925011012351e-07,1.68787674629709e-07,2.9113605069629e-08,4.21199889576943e-09,5.09638755752928e-10],[0.00247575212820804,0.00279370853349698,0.0027515285389952,0.00248471635445634,0.00217768402609266,0.00192624925240054,0.00171256387552738,0.00146611150255725,0.00114618614210518,0.000787351517632539,0.000470926949531804,0.000255403468635934,0.000140225140419774,8.68649532956368e-05,5.80418194248358e-05,3.63567873000886e-05,1.94163761030336e-05,8.50575509150092e-06,3.02073135391069e-06,8.68765991137761e-07,2.03108370536072e-07,3.88554121285071e-08,6.1323631113589e-09,8.05013832034892e-10,8.84262601460625e-11],[0.00222810048712189,0.00240711185713688,0.00226941150735108,0.00195506450726412,0.00161254025361887,0.00131348321080274,0.00106251975415001,0.000835393660243612,0.000611752053621267,0.000398357803133751,0.000223809784230041,0.000108994672772302,4.92973571293224e-05,2.38917487607935e-05,1.3417782642461e-05,7.80200476378976e-06,4.057190761583e-06,1.75327303389372e-06,6.13916404141525e-07,1.73027122650087e-07,3.92562319465047e-08,7.19284568457656e-09,1.07017132518722e-09,1.30235989966091e-10,1.30742002882528e-11],[0.00171210400212498,0.00178009849590719,0.00161203992304887,0.00133113459963996,0.00104270884592682,0.000788709142088073,0.000576684584539615,0.000405489660289202,0.000269327363345885,0.000162980486943903,8.63105040688027e-05,3.9109359104307e-05,1.54601714150422e-05,5.88214910043934e-06,2.52452312610639e-06,1.25128176054242e-06,6.1235678227539e-07,2.59202738911165e-07,8.98423371593413e-08,2.50694366444913e-08,5.60857113931821e-09,1.0063524985112e-09,1.45175373046061e-10,1.69064506991318e-11,1.598603403865e-12]],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Bivariate Density (rho = -0.80)","scene":{"xaxis":{"title":[]},"yaxis":{"title":[]},"zaxis":{"title":[]}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[88.9398907298665,89.8067295301701,90.6735683304737,91.5404071307773,92.4072459310809,93.2740847313845,94.1409235316881,95.0077623319917,95.8746011322953,96.7414399325989,97.6082787329024,98.475117533206,99.3419563335096,100.208795133813,101.075633934117,101.94247273442,102.809311534724,103.676150335028,104.542989135331,105.409827935635,106.276666735938,107.143505536242,108.010344336546,108.877183136849,109.744021937153],"y":[92.3004145455501,92.9920082957279,93.6836020459057,94.3751957960835,95.0667895462613,95.758383296439,96.4499770466168,97.1415707967946,97.8331645469724,98.5247582971502,99.2163520473279,99.9079457975057,100.599539547683,101.291133297861,101.982727048039,102.674320798217,103.365914548395,104.057508298572,104.74910204875,105.440695798928,106.132289549106,106.823883299284,107.515477049461,108.207070799639,108.898664549817],"z":[[6.85666889382839e-11,2.56461062778276e-10,9.14548163093976e-10,3.26626647514284e-09,1.12750183663048e-08,3.4785687172498e-08,9.07838153113766e-08,1.99001293966871e-07,3.97141310428745e-07,9.22358341739491e-07,3.02026975362924e-06,1.13066974739126e-05,3.8170877923777e-05,0.000106719835351139,0.000241828993363136,0.00044269764711603,0.000659596627729255,0.000821128669645684,0.000910306523017004,0.000998058016700087,0.00116204483952298,0.00137182421139454,0.00149162068465402,0.00140776035786185,0.00113026510110035],[1.11615835674272e-09,3.84835427750987e-09,1.19025888503256e-08,3.57462738075808e-08,1.07444931103708e-07,3.06461164075519e-07,7.68178653776298e-07,1.61731450130647e-06,2.86382881071087e-06,4.61741514587336e-06,8.34415807496569e-06,1.9876453215551e-05,5.36950913343337e-05,0.000134123762947215,0.000284001240966961,0.000497275803454737,0.000719821719970888,0.000881793499810989,0.000975332234608128,0.0010850071155523,0.00129943523477154,0.00158618751397982,0.00178751203904542,0.00175422575404816,0.00146879928618221],[1.31235745879944e-08,4.32261402658838e-08,1.21441417745742e-07,3.12211604633419e-07,7.91313402231582e-07,1.99502482158448e-06,4.68361957852786e-06,9.53946591847351e-06,1.63204364686323e-05,2.38857454313454e-05,3.29766089112879e-05,5.13729957487455e-05,9.71083187883779e-05,0.000193506430965398,0.000352718867993018,0.000554654243080187,0.000743530318951299,0.000864784960156907,0.000925570327380137,0.00100962423772967,0.00119937119482059,0.00147023418632963,0.00168166704076597,0.00168712279177908,0.00144898843411981],[1.09911343641979e-07,3.53563894903477e-07,9.39362367460101e-07,2.15980928884618e-06,4.6378730433022e-06,9.92783386768111e-06,2.09242589069714e-05,4.03802128790854e-05,6.71980432684405e-05,9.51053195858386e-05,0.000119947213858853,0.00015262569540425,0.000223046812735061,0.000363539911042556,0.000578957845443621,0.000827456482736782,0.00103394331761079,0.00113621692616736,0.00113556478222011,0.00110559076341983,0.00113213674484974,0.00122745909378559,0.0013096947547856,0.00127486819825425,0.00108474871733017],[6.5168763122664e-07,2.07253371905638e-06,5.34748710361426e-06,1.14929223889604e-05,2.172675273907e-05,3.91357716858365e-05,7.07663013794747e-05,0.000124573022267512,0.00019870514029092,0.000275248237941528,0.000335841521218775,0.00039184651856227,0.000494216542819814,0.00070237907227133,0.00103341003020348,0.00143150763374217,0.00178090129597042,0.00195990830390536,0.00191368292349384,0.00169662837575476,0.00143182272642004,0.00121082032443105,0.00103736693992751,0.000865552029230912,0.000667567909650526],[2.73464694867009e-06,8.65457543271709e-06,2.20211302176026e-05,4.56632587600797e-05,7.9662368601395e-05,0.000124449183345366,0.000188898368924797,0.000289417558050988,0.000429120264312591,0.000579483381917023,0.000702393622055255,0.00080228003400572,0.000946800193929489,0.00122574680288443,0.00168433651808754,0.00227445151669815,0.0028417149090851,0.00317240617257218,0.00311438759132685,0.00269448064291072,0.00209944463137004,0.00152463821067587,0.00105908347737357,0.000703246018178874,0.000437586623696983],[8.16989145215803e-06,2.58163915535273e-05,6.53337797583114e-05,0.000133267930326929,0.000222774367596013,0.000317081936966473,0.000412668922636484,0.000533958577489767,0.000706627554088166,0.000917066749559779,0.00112423798950584,0.00132153171526058,0.00156780323523225,0.00194920417151718,0.00251567573961144,0.00322696141195755,0.00391347487964094,0.00430484673322298,0.00418422803684917,0.00356790028782686,0.00270136612373187,0.00185967326028506,0.00118429053089977,0.000694045751741409,0.000366144417563987],[1.7705973401565e-05,5.58090498598399e-05,0.000141032375099624,0.000286211619331567,0.000470164799662055,0.000638624428175901,0.000753001902392312,0.000840711276000456,0.000974778279506381,0.00120128148570241,0.0015126142903653,0.00189326875149723,0.00235896848447161,0.00293798529019944,0.00362683365966636,0.00435112114887996,0.00493639950698799,0.00513717081088634,0.0047800730693443,0.00392830045885396,0.00286569552423162,0.0018892289160653,0.0011426007840506,0.000630569723667282,0.000309376215249178],[2.95549692713721e-05,9.11520574802817e-05,0.00022875383913956,0.000463964388847512,0.000761684129362018,0.00102533199181644,0.0011725858998501,0.00123001217495882,0.00132816027750187,0.00159405346304718,0.00206790163984292,0.00271730733745129,0.00349063722457331,0.00433357295279647,0.00516238920038595,0.00583393121027146,0.00615365433200052,0.0059444070885943,0.00516365892538808,0.0039847636763741,0.00272919051261671,0.0016770817049814,0.000937868756291197,0.000478461538355227,0.000218756974259418],[4.58799437780387e-05,0.000127371340415318,0.0003045329283728,0.000609282536610866,0.00100834278938046,0.00139126254703779,0.00165689693859952,0.00183289494648892,0.00208077882353108,0.00256415920766287,0.00332448813195212,0.00427760931685683,0.00529567801835271,0.00626933854407633,0.00708869730661971,0.00758777145001986,0.00756028692402217,0.0068782179032787,0.00561752498474101,0.00406859761261279,0.00259883381657567,0.00146730433718884,0.000738326116317373,0.000333715062783288,0.000135313571850087],[9.04307834004146e-05,0.000199978786021514,0.00041145208825048,0.000767864979242401,0.00126465397178254,0.00182903009763921,0.00238655427492837,0.00296396715964237,0.00368781267018262,0.00465306525085559,0.00580588669340734,0.00696198209263478,0.00792989261668283,0.00861357924861013,0.00899030709756365,0.00899779672166434,0.00849489561486629,0.0073848303868999,0.00577759409090739,0.00400026338986493,0.00242657035979037,0.00128377137177582,0.000592009591046872,0.000238414229292211,8.40530495290131e-05],[0.000219621096545493,0.000406718653022114,0.0007025663678406,0.00116343902194707,0.00183840071775762,0.00273060454348387,0.00381160031183083,0.00507601805508973,0.00653082969589267,0.00809523279440875,0.00953879609998321,0.0105625620978281,0.0109706572990055,0.010783563789338,0.0101810262644235,0.00931721668817131,0.0081998514382664,0.0067707951358342,0.00509037860939661,0.00339934903303321,0.00198454453574152,0.00100392578287881,0.000437806583383735,0.000163931123032876,5.251405063661e-05],[0.000487552616338708,0.000844350089539425,0.00134098609947208,0.00205350262742157,0.00309322793609741,0.00452712408236722,0.00632363115232282,0.00837318279733729,0.0105009855544983,0.0124208933370359,0.0137389391360079,0.0141082725662149,0.0134428704183162,0.0119910167609991,0.0101847910450437,0.00838366547146284,0.00672064653854754,0.0051598387391375,0.00367479409475276,0.00235003648272868,0.00131803531822095,0.000639545334411646,0.000266510244287618,9.4870630575931e-05,2.8678232923752e-05],[0.000862791917691593,0.00146032814244806,0.00225714633918541,0.00335600997585559,0.00491558180871327,0.00700804719155804,0.00951027303222967,0.0121426069631282,0.0145512662211511,0.0163178987394588,0.0169999962088472,0.0163304611938991,0.0144392788921922,0.0118377237857227,0.00914189225668659,0.00677754340068518,0.00488056942327614,0.0033939443415516,0.00222420239316539,0.00132937839875018,0.000703929464053635,0.000323849152419299,0.000128052662765595,4.3254659267416e-05,1.24157601106926e-05],[0.00120526998400815,0.00201431562788824,0.00307458016821542,0.00450621434948806,0.00648115136626639,0.00902715835194616,0.0118996491241045,0.0146714162868047,0.0168876808541337,0.0181125888921989,0.0179794919036685,0.0163899305866742,0.0136892440535825,0.0105483922761543,0.00760918988123397,0.00521725137860985,0.00342293261060348,0.00213570751851605,0.0012469600071104,0.0006671134103092,0.000319999729821679,0.000135033811544371,4.94297685407141e-05,1.55555447784646e-05,4.18302001774013e-06],[0.00139968689759105,0.00231044264006865,0.00347196125687355,0.00498466374662915,0.00699208093503516,0.00947707531869666,0.0121452294836972,0.0145428695763928,0.0162337099982018,0.0168558548572954,0.0161735944997398,0.0142403742712271,0.011492337753115,0.00856959371511669,0.00598840180332856,0.00396184923892789,0.00247106746855414,0.0014263456221857,0.000745526748746561,0.000347548702604191,0.000143482097262019,5.22842229144714e-05,1.67510580676872e-05,4.69106023748056e-06,1.1403433570134e-06],[0.00151709393267833,0.00245227226940204,0.00357487077721427,0.00492143338973997,0.00657609752632379,0.00850378476945546,0.0104575028025069,0.0120844254448121,0.0130727687045445,0.0131954965717884,0.0123490469272068,0.0106569102176895,0.00848896805852828,0.00629557095248751,0.00439467366885379,0.00289601426887205,0.00177747823854604,0.000988763394936515,0.000484064894229241,0.000204190396317799,7.3535185478648e-05,2.26488325716307e-05,6.02072713594894e-06,1.39719899526003e-06,2.85430831382039e-07],[0.00175243781679329,0.00271836303202744,0.00375981850055126,0.00483727081300309,0.00597951837672207,0.00715756825707258,0.00821283743797088,0.0089405941941086,0.00919726466523418,0.00891758610017268,0.00811431147256506,0.00691075890599943,0.00552172310932043,0.00415763779188178,0.00294997142629689,0.00195361851530932,0.00118430377600547,0.000640432714312719,0.000300827084113726,0.000120038258751629,4.00821377509778e-05,1.11223662844322e-05,2.56764985657158e-06,4.97518400751407e-07,8.21960993192181e-08],[0.00214214366471261,0.00313808682193879,0.00406745696653187,0.00485222131900009,0.00551250441933312,0.00604710669963634,0.00636978986103137,0.00638413056064758,0.00607443541312872,0.00550600568032104,0.00477952126628566,0.00399710178228299,0.00323009198618831,0.00250147688177082,0.0018161432234738,0.00120299556611057,0.000710162840905731,0.000366934913040787,0.000163393098002776,6.17768250224477e-05,1.95585587970514e-05,5.12692117215287e-06,1.10452392022524e-06,1.9505157799594e-07,2.83158615593228e-08],[0.00247038137276678,0.00339675746458354,0.00411703768025453,0.00458188714213629,0.00486118573165939,0.0049970535712664,0.00493627141581355,0.00461087647274645,0.00404184435710605,0.00335012354951096,0.00268645574434491,0.00214768638737768,0.00173372154420607,0.00137639937593574,0.00101964183992951,0.00067200307859708,0.000382908681932882,0.000186282149090324,7.70274148744226e-05,2.6986047019004e-05,7.96669193870036e-06,1.96565376966442e-06,4.01604408184758e-07,6.73822240027374e-08,9.23048965291072e-09],[0.00257641800108467,0.00330489255779684,0.00372685077589713,0.00386952913459893,0.00387554889621464,0.00382610745785675,0.00367140424274825,0.00331921597902061,0.00276022889072584,0.00210616755199578,0.00151896254288375,0.00110143829958839,0.000844032459599759,0.00066506062519795,0.000495200410754434,0.000324008925164832,0.000179275856474936,8.27138562006869e-05,3.17778464428013e-05,1.02053487631905e-05,2.75104771062703e-06,6.23231990309589e-07,1.1827767384227e-07,1.86769912018289e-08,2.43352004078936e-09],[0.00255143375431312,0.00305017012969949,0.00319217748546576,0.00307688112075409,0.00289215014672367,0.00273848438274123,0.00257296000518896,0.00229221630381501,0.00185464728489241,0.00133435333868465,0.00086643634148012,0.000543492964712101,0.000364142399470306,0.000266548356480978,0.000193399102449354,0.000124931054144076,6.78111280138756e-05,3.02587347460922e-05,1.10471029770642e-05,3.30985074146116e-06,8.1925011012351e-07,1.68787674629709e-07,2.9113605069629e-08,4.21199889576943e-09,5.09638755752928e-10],[0.00247575212820804,0.00279370853349698,0.0027515285389952,0.00248471635445634,0.00217768402609266,0.00192624925240054,0.00171256387552738,0.00146611150255725,0.00114618614210518,0.000787351517632539,0.000470926949531804,0.000255403468635934,0.000140225140419774,8.68649532956368e-05,5.80418194248358e-05,3.63567873000886e-05,1.94163761030336e-05,8.50575509150092e-06,3.02073135391069e-06,8.68765991137761e-07,2.03108370536072e-07,3.88554121285071e-08,6.1323631113589e-09,8.05013832034892e-10,8.84262601460625e-11],[0.00222810048712189,0.00240711185713688,0.00226941150735108,0.00195506450726412,0.00161254025361887,0.00131348321080274,0.00106251975415001,0.000835393660243612,0.000611752053621267,0.000398357803133751,0.000223809784230041,0.000108994672772302,4.92973571293224e-05,2.38917487607935e-05,1.3417782642461e-05,7.80200476378976e-06,4.057190761583e-06,1.75327303389372e-06,6.13916404141525e-07,1.73027122650087e-07,3.92562319465047e-08,7.19284568457656e-09,1.07017132518722e-09,1.30235989966091e-10,1.30742002882528e-11],[0.00171210400212498,0.00178009849590719,0.00161203992304887,0.00133113459963996,0.00104270884592682,0.000788709142088073,0.000576684584539615,0.000405489660289202,0.000269327363345885,0.000162980486943903,8.63105040688027e-05,3.9109359104307e-05,1.54601714150422e-05,5.88214910043934e-06,2.52452312610639e-06,1.25128176054242e-06,6.1235678227539e-07,2.59202738911165e-07,8.98423371593413e-08,2.50694366444913e-08,5.60857113931821e-09,1.0063524985112e-09,1.45175373046061e-10,1.69064506991318e-11,1.598603403865e-12]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="simulating-power" class="section level2">
<h2>Simulating Power</h2>
<p>There is a variety of perspectives on the definition of power. Simply put, power is the probability of avoiding a Type II error, according to Neil Weiss in Introductory Statistics. In the section below we explore the concept of power by examining a two-way ANOVA with interaction. Note that for simplicity, I used arbitrarily picked values for the model instead of real empirical data. In the context of a two-way ANOVA with interaction, we could interpret power as <em>the probability that a test of significance will pick up on an effect that is present</em>.</p>
<pre class="r"><code># Define a function for a two-way anova model with interaction
two_way_anova_interaction_regression &lt;- function(n, b0, b1, b2, b3,
                                                 x1_mean = 0, x1_sd = 1, err_mean = 0, err_sd = 1) {

  # x1 draws n values from a normal distribution with a mean of 0 &amp; sd of 1
  # x2 draws integers btw 0 to 1, n times (i.e., n numbers of either 0 or 1)
  x1 &lt;- rnorm(n, mean = x1_mean, sd = x1_sd)
  x2 &lt;- sample(0:1, n, replace = TRUE)

  # y is a linear combination of x1 &amp; x2 multiplied by coefficients/effect sizes
  # the last term is the error term-- i.e. the unexplained portion of y
  y &lt;- b0 + (b1 * x1) + (b2 * x2) + (b3 * x1 * x2) + rnorm(n, mean = err_mean, sd = err_sd)

  # regression model
  anova_model &lt;- lm(y ~ x1 * x2)
  summary(anova_model)

  # store model outputs
  output &lt;- summary(anova_model)$coefficients
  coeffs &lt;- output[, 1]
  p_values &lt;- output[, 4]
  r_sqr &lt;- summary(anova_model)$r.squared

  # output
  results &lt;- c(coeffs, p_values, r_sqr)
  names(results) &lt;- c(
    &quot;$\\beta_{0}$&quot;, &quot;$\\beta_{1}$&quot;, &quot;$\\beta_{2}$&quot;,
    &quot;$\\beta_{3}$&quot;, &quot;$\\beta_{0}$_pvalue&quot;,
    &quot;$\\beta_{1}$_pvalue&quot;, &quot;$\\beta_{2}$_pvalue&quot;,
    &quot;$\\beta_{3}$_pvalue&quot;, &quot;$r^2$&quot;
  )
  return(results)
}</code></pre>
<p>Let’s try using this function :</p>
<pre class="r"><code># Using arbitrarily picked values
anova_model &lt;- two_way_anova_interaction_regression(n = 100, b0 = 0, b1 = 0.2, b2 = 0.4, b3 = 0.5)
# Generate table using kable () function from the knitr package
knitr::kable(anova_model, caption = &quot;Two-way ANOVA Regression Model with Interaction&quot;)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-14">Table 1: </span>Two-way ANOVA Regression Model with Interaction</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><span class="math inline">\(\beta_{0}\)</span></td>
<td align="right">0.0310109</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\beta_{1}\)</span></td>
<td align="right">0.2611402</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\beta_{2}\)</span></td>
<td align="right">0.5979107</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\beta_{3}\)</span></td>
<td align="right">0.3640547</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\beta_{0}\)</span>_pvalue</td>
<td align="right">0.8446025</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\beta_{1}\)</span>_pvalue</td>
<td align="right">0.1368724</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(\beta_{2}\)</span>_pvalue</td>
<td align="right">0.0042647</td>
</tr>
<tr class="even">
<td align="left"><span class="math inline">\(\beta_{3}\)</span>_pvalue</td>
<td align="right">0.1080374</td>
</tr>
<tr class="odd">
<td align="left"><span class="math inline">\(r^2\)</span></td>
<td align="right">0.2291234</td>
</tr>
</tbody>
</table>
<p>Now, we run 1000 simulations of the model, finding the coefficients and their associating p-values for each iteration. The output would be a data frame, with one row per simulation:</p>
<pre class="r"><code># Number of simulations
num_sims &lt;- 1000
# Using a function called ldply() from the plyr package by Hadley Wickham
# ldply () applies function for each element of a list then combine results into a data frame.
power_simulations &lt;- ldply(1:num_sims, two_way_anova_interaction_regression,
  n = 100, b0 = 0, b1 = 0.2, b2 = 0.4, b3 = 0.5
)
# First 5 rows
knitr::kable(power_simulations[1:5, ], caption = &quot;Two-way ANOVA Regression Model with Interaction&quot;)</code></pre>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-15">Table 2: </span>Two-way ANOVA Regression Model with Interaction</caption>
<colgroup>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="right"><span class="math inline">\(\beta_{0}\)</span></th>
<th align="right"><span class="math inline">\(\beta_{1}\)</span></th>
<th align="right"><span class="math inline">\(\beta_{2}\)</span></th>
<th align="right"><span class="math inline">\(\beta_{3}\)</span></th>
<th align="right"><span class="math inline">\(\beta_{0}\)</span>_pvalue</th>
<th align="right"><span class="math inline">\(\beta_{1}\)</span>_pvalue</th>
<th align="right"><span class="math inline">\(\beta_{2}\)</span>_pvalue</th>
<th align="right"><span class="math inline">\(\beta_{3}\)</span>_pvalue</th>
<th align="right"><span class="math inline">\(r^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.1657905</td>
<td align="right">0.1852724</td>
<td align="right">0.7968441</td>
<td align="right">0.5459245</td>
<td align="right">0.4342815</td>
<td align="right">0.2469565</td>
<td align="right">0.0103175</td>
<td align="right">0.0136621</td>
<td align="right">0.4588430</td>
</tr>
<tr class="even">
<td align="right">-0.1945950</td>
<td align="right">0.2394697</td>
<td align="right">0.7110830</td>
<td align="right">0.3147623</td>
<td align="right">0.5081150</td>
<td align="right">0.0582744</td>
<td align="right">0.0991120</td>
<td align="right">0.1033851</td>
<td align="right">0.3969188</td>
</tr>
<tr class="odd">
<td align="right">-0.7726047</td>
<td align="right">0.5142571</td>
<td align="right">0.8882506</td>
<td align="right">0.2458852</td>
<td align="right">0.0712582</td>
<td align="right">0.0000984</td>
<td align="right">0.1898985</td>
<td align="right">0.2411440</td>
<td align="right">0.5116927</td>
</tr>
<tr class="even">
<td align="right">1.3787538</td>
<td align="right">-0.1250316</td>
<td align="right">-1.2926884</td>
<td align="right">0.8758351</td>
<td align="right">0.0884618</td>
<td align="right">0.5130762</td>
<td align="right">0.1906276</td>
<td align="right">0.0003018</td>
<td align="right">0.6237839</td>
</tr>
<tr class="odd">
<td align="right">0.2492963</td>
<td align="right">0.1122680</td>
<td align="right">-0.2806965</td>
<td align="right">0.7228013</td>
<td align="right">0.7372446</td>
<td align="right">0.4271540</td>
<td align="right">0.7963389</td>
<td align="right">0.0010111</td>
<td align="right">0.7472213</td>
</tr>
</tbody>
</table>
<p>We can estimate power by finding the proportion of p-values that are significant. We are primarily interested in the p-value for the interaction effect, <span class="math inline">\(\beta_{3}\)</span>. We use a logical expression to find out whether the p-values of <span class="math inline">\(\beta_{3}\)</span> is less than .05. This would return a logical vector of TRUEs and FALSEs. We then sum this vector (TRUE gets counted as 1 &amp; FALSE as 0). Finally, we divide this value by the total number of simulations, 1000, to get the proportion:</p>
<pre class="r"><code># Estimating Power
power &lt;- sum(power_simulations[[8]] &lt; .05) / nrow(power_simulations)
cat(power)</code></pre>
<pre><code>0.67</code></pre>
<p>We could tweak the parameters to see how it affects our power estimate. For instance, we could investigate what happens when we increase sample sizes for x1 and x2:</p>
<pre class="r"><code># Create a vector of sample sizes ranging from 50 to 500
sample_sizes &lt;- c(50, 100, 200, 300, 500)
# Initualize variable
results &lt;- list()
# For Loop
for (val in sample_sizes) {

  # cycle through each value in &quot;sample_sizes&quot; and sets val to be that value
  # then pass that value to the simulation function as the sample size n
  power_simulations &lt;- ldply(1:1000, two_way_anova_interaction_regression,
    n = val, b0 = 0, b1 = 0.3, b2 = 0.2, b3 = 0.3
  )

  # create new variable called n in the output data frame &quot;results&quot;
  # this variable functions as an indentifier
  power_simulations$n &lt;- as.factor(val)


  # rbind() combines data frames by rows
  # notice that the first argument &quot;results&quot; in rbind() is an empty list when val=50
  # after each cycle, this dataframe gets 1000 more rows added to it
  # in the end we should have a single data frame with 5000 rows as there are five values in &quot;sample_sizes&quot;
  results &lt;- rbind(results, power_simulations)
}</code></pre>
<p>We could examine the results using a table and a plot:</p>
<pre class="r"><code># Split results into five individual data frames using the variable &quot;n&quot; as the identifier
list_of_results &lt;- split(results, results[[10]])
# Find the power estimates associated with each sample size
power_n_50 &lt;- sum(list_of_results[[&quot;50&quot;]][[8]] &lt; .05) / nrow(list_of_results[[&quot;50&quot;]])
power_n_100 &lt;- sum(list_of_results[[&quot;100&quot;]][[8]] &lt; .05) / nrow(list_of_results[[&quot;100&quot;]])
power_n_200 &lt;- sum(list_of_results[[&quot;200&quot;]][[8]] &lt; .05) / nrow(list_of_results[[&quot;200&quot;]])
power_n_300 &lt;- sum(list_of_results[[&quot;300&quot;]][[8]] &lt; .05) / nrow(list_of_results[[&quot;300&quot;]])
power_n_500 &lt;- sum(list_of_results[[&quot;500&quot;]][[8]] &lt; .05) / nrow(list_of_results[[&quot;500&quot;]])
# Store all power estimates in one single vector
power_estimates &lt;- c(power_n_50, power_n_100, power_n_200, power_n_300, power_n_500)
# Create data frame
power_table &lt;- data.frame(
  &quot;Sample Size&quot; = sample_sizes,
  &quot;Power Estimate&quot; = power_estimates
)
# Generate table using kable () function from the knitr package
knitr::kable(power_table, caption = &quot;Power Estimates by Sample Size&quot;)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-18">Table 3: </span>Power Estimates by Sample Size</caption>
<thead>
<tr class="header">
<th align="right">Sample.Size</th>
<th align="right">Power.Estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">50</td>
<td align="right">0.175</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.284</td>
</tr>
<tr class="odd">
<td align="right">200</td>
<td align="right">0.542</td>
</tr>
<tr class="even">
<td align="right">300</td>
<td align="right">0.728</td>
</tr>
<tr class="odd">
<td align="right">500</td>
<td align="right">0.910</td>
</tr>
</tbody>
</table>
<pre class="r"><code># Using ggplot()
p &lt;- ggplot(data = power_table, aes(x = Sample.Size, y = Power.Estimate))
p &lt;- p + geom_point(color = &quot;orange&quot;)
p &lt;- p + geom_line(color = &quot;orange&quot;)
p &lt;- p + geom_hline(yintercept = 0.8, linetype = &quot;dashed&quot;)
p &lt;- p + ylim(c(0, 1))
p &lt;- p + ggtitle(&quot;Power Estimates by Sample Size&quot;) + xlab(&quot;Sample Size&quot;) + ylab(&quot;Power Estimates&quot;)
p &lt;- p + theme(panel.background = element_rect(fill = &quot;azure2&quot;))
p</code></pre>
<p><img src="https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/index_files/figure-html/unnamed-chunk-19-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>As can be seen, our power estimates increase as sample size increases. If we take 0.8 as the rough rule of thumb of desired level of power, then a sample size of <span class="math inline">\(\approx350\)</span> would yield us that level of power given the set of parameters I chose.</p>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/simulation/">Simulation</a>
  
  <a class="badge badge-light" href="/tag/central-limit-theorem/">Central Limit Theorem</a>
  
  <a class="badge badge-light" href="/tag/statistics/">Statistics</a>
  
  <a class="badge badge-light" href="/tag/probability/">Probability</a>
  
  <a class="badge badge-light" href="/tag/statistical-power/">Statistical Power</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/&amp;text=The%20Central%20Limit%20Theorem%20and%20Power%20Simulation" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/&amp;t=The%20Central%20Limit%20Theorem%20and%20Power%20Simulation" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=The%20Central%20Limit%20Theorem%20and%20Power%20Simulation&amp;body=https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/&amp;title=The%20Central%20Limit%20Theorem%20and%20Power%20Simulation" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=The%20Central%20Limit%20Theorem%20and%20Power%20Simulation%20https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://academic-demo.netlify.app/post/central-limit-theorem-and-power-simulation/&amp;title=The%20Central%20Limit%20Theorem%20and%20Power%20Simulation" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://academic-demo.netlify.app/"><img class="avatar mr-3 avatar-circle" src="/author/yang-ken-wu/avatar_hu5209c67c5d796189810bebc1ea7397e2_2226757_270x270_fill_q75_lanczos_center.jpg" alt="Yang (Ken) Wu"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://academic-demo.netlify.app/">Yang (Ken) Wu</a></h5>
      
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.instagram.com/kennywu12/" target="_blank" rel="noopener">
        <i class="fab fa-instagram"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/YangWu1227/" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://stackoverflow.com/users/12923148/yang-wu/" target="_blank" rel="noopener">
        <i class="ai ai-stackoverflow"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/yangwu1227/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/post/implementing-math-concepts-in-r/">Implementing Mathematical Concepts in R</a></li>
      
      <li><a href="/project/modeling-prostate-specific-antigen-levels/">Modeling Prostate-Specific Antigen Levels in Cancer Patients</a></li>
      
      <li><a href="/project/modeling-lumber-volume-from-tree-diameter/">Modeling Lumber Volume From Tree Diameter</a></li>
      
    </ul>
  </div>
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  
  <p class="powered-by">
    © 2021 Yang Wu
  </p>
  

  
  






  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/latex.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    <script src="/js/bootstrap.bundle.min.6aed84840afc03ab4d5750157f69c120.js"></script>

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.d68ecd57c0ec1f1f61d65fd568f1c3a0.js"></script>

    
  <script async defer src="https://buttons.github.io/buttons.js"></script>




</body>
</html>
