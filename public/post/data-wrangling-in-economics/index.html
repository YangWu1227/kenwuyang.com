<!DOCTYPE html><html lang="en-us" >

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.3.0 for Hugo" />
  

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Yang (Ken) Wu" />

  
  
  
    
  
  <meta name="description" content="Some data wrangling techniques in the Tidyverse" />

  
  <link rel="alternate" hreflang="en-us" href="YangWu1227.github.io/post/data-wrangling-in-economics/" />

  









  




  
  

  
  
  
    <meta name="theme-color" content="#707070" />
  

  
  
    
    <script src="/YangWu1227.github.io/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  

  
  
  
  
  
  <link rel="stylesheet" href="/YangWu1227.github.io/css/wowchemy.ac7c0ed2b158b87562a0b9c331d7a57e.css" />

  



  

  

  




  
  
  

  

  
    <link rel="manifest" href="YangWu1227.github.io/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/YangWu1227.github.io/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/YangWu1227.github.io/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="YangWu1227.github.io/post/data-wrangling-in-economics/" />

  
  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image" />
  
  <meta property="og:site_name" content="Yang (Ken) Wu" />
  <meta property="og:url" content="YangWu1227.github.io/post/data-wrangling-in-economics/" />
  <meta property="og:title" content="Data Wrangling with Economics Data | Yang (Ken) Wu" />
  <meta property="og:description" content="Some data wrangling techniques in the Tidyverse" /><meta property="og:image" content="/YangWu1227.github.io/post/data-wrangling-in-economics/featured.jpeg" />
    <meta property="twitter:image" content="/YangWu1227.github.io/post/data-wrangling-in-economics/featured.jpeg" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2020-05-04T21:13:14-05:00"
      />
    
    <meta property="article:modified_time" content="2020-05-04T21:13:14-05:00">
  

  


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "YangWu1227.github.io/post/data-wrangling-in-economics/"
  },
  "headline": "Data Wrangling with Economics Data",
  
  "image": [
    "/YangWu1227.github.io/post/data-wrangling-in-economics/featured.jpeg"
  ],
  
  "datePublished": "2020-05-04T21:13:14-05:00",
  "dateModified": "2020-05-04T21:13:14-05:00",
  
  "author": {
    "@type": "Person",
    "name": "Yang (Ken) Wu"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Yang (Ken) Wu",
    "logo": {
      "@type": "ImageObject",
      "url": "/YangWu1227.github.io/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "Some data wrangling techniques in the Tidyverse"
}
</script>

  

  

  

  





  <title>Data Wrangling with Economics Data | Yang (Ken) Wu</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="4ad8acf737f8a90911355b7ad8363f94" >

  
  
  
  
  
  
  
  
  
  <script src="/YangWu1227.github.io/js/wowchemy-init.min.8988fb2a4bba758785868cfcb5244555.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/YangWu1227.github.io/">Yang (Ken) Wu</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/YangWu1227.github.io/">Yang (Ken) Wu</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/YangWu1227.github.io/#about"><span>About</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/YangWu1227.github.io/#posts"><span>Posts</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/YangWu1227.github.io/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/YangWu1227.github.io/#contact"><span>Contact</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
          
          <li class="nav-item d-none d-lg-inline-flex">
            <a class="nav-link" href="https://www.instagram.com/kennywu12/" data-toggle="tooltip" data-placement="bottom" title="Follow me on Instgram" target="_blank" rel="noopener" aria-label="Follow me on Instgram">
              <i class="fab fa-instagram" aria-hidden="true"></i>
            </a>
          </li>
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Data Wrangling with Economics Data</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Monday, 04 May 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    12 min read
  </span>
  

  
  
  
  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="YangWu1227.github.io/category/r/">R</a></span>
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 883px;">
  <div style="position: relative">
    <img src="/YangWu1227.github.io/post/data-wrangling-in-economics/featured_hu3e30f3d5f32c3c34c2aff4a19a6c7d4c_77541_720x0_resize_q75_lanczos.jpeg" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      
<script src="YangWu1227.github.io/post/data-wrangling-in-economics/index_files/header-attrs/header-attrs.js"></script>


<div id="data-wrangling" class="section level2">
<h2>Data Wrangling</h2>
<p>In this activity, I would like to experiment with some data wrangling techniques. I would be using the Penn World Table version 9.1 (PWT 9.1) and the Cross National Time Series (CNTS) data set to practice these techniques.</p>
</div>
<div id="data-importation" class="section level2">
<h2>Data Importation</h2>
<pre class="r"><code>pwt91 &lt;- read_csv(&quot;pwt91.csv&quot;)
Rows: 12376 Columns: 52
── Column specification ────────────────────────────────────────────────────────
Delimiter: &quot;,&quot;
chr  (8): countrycode, country, currency_unit, i_cig, i_xm, i_xr, i_outlier,...
dbl (44): year, rgdpe, rgdpo, pop, emp, avh, hc, ccon, cda, cgdpe, cgdpo, cn...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>The first thing we would do is to coerce the data frame into a tibble (in my case, it is already a tibble but sometimes it may not be so it’s good to be safe):</p>
<pre class="r"><code>pwt91 &lt;- pwt91 %&gt;% as_tibble()
pwt91
# A tibble: 12,376 × 52
   countrycode country currency_unit   year rgdpe rgdpo   pop   emp   avh    hc
   &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 ABW         Aruba   Aruban Guilder  1950    NA    NA    NA    NA    NA    NA
 2 ABW         Aruba   Aruban Guilder  1951    NA    NA    NA    NA    NA    NA
 3 ABW         Aruba   Aruban Guilder  1952    NA    NA    NA    NA    NA    NA
 4 ABW         Aruba   Aruban Guilder  1953    NA    NA    NA    NA    NA    NA
 5 ABW         Aruba   Aruban Guilder  1954    NA    NA    NA    NA    NA    NA
 6 ABW         Aruba   Aruban Guilder  1955    NA    NA    NA    NA    NA    NA
 7 ABW         Aruba   Aruban Guilder  1956    NA    NA    NA    NA    NA    NA
 8 ABW         Aruba   Aruban Guilder  1957    NA    NA    NA    NA    NA    NA
 9 ABW         Aruba   Aruban Guilder  1958    NA    NA    NA    NA    NA    NA
10 ABW         Aruba   Aruban Guilder  1959    NA    NA    NA    NA    NA    NA
# … with 12,366 more rows, and 42 more variables: ccon &lt;dbl&gt;, cda &lt;dbl&gt;,
#   cgdpe &lt;dbl&gt;, cgdpo &lt;dbl&gt;, cn &lt;dbl&gt;, ck &lt;dbl&gt;, ctfp &lt;dbl&gt;, cwtfp &lt;dbl&gt;,
#   rgdpna &lt;dbl&gt;, rconna &lt;dbl&gt;, rdana &lt;dbl&gt;, rnna &lt;dbl&gt;, rkna &lt;dbl&gt;,
#   rtfpna &lt;dbl&gt;, rwtfpna &lt;dbl&gt;, labsh &lt;dbl&gt;, irr &lt;dbl&gt;, delta &lt;dbl&gt;, xr &lt;dbl&gt;,
#   pl_con &lt;dbl&gt;, pl_da &lt;dbl&gt;, pl_gdpo &lt;dbl&gt;, i_cig &lt;chr&gt;, i_xm &lt;chr&gt;,
#   i_xr &lt;chr&gt;, i_outlier &lt;chr&gt;, i_irr &lt;chr&gt;, cor_exp &lt;dbl&gt;, statcap &lt;dbl&gt;,
#   csh_c &lt;dbl&gt;, csh_i &lt;dbl&gt;, csh_g &lt;dbl&gt;, csh_x &lt;dbl&gt;, csh_m &lt;dbl&gt;, …</code></pre>
</div>
<div id="wrangling" class="section level2">
<h2>Wrangling</h2>
<p>We first need to “mutate” some variables. The total employment numbers do not offer as much context as the employment–population ratios; we create a new variable by dividing total employment by population. Next, we “select” the variables that are of interest to us. Suppose we wish to keep the following variables: countrycode, country name, year, employment–population ratios.</p>
<pre class="r"><code>pwt91 &lt;- pwt91 %&gt;%
  mutate(emp_pop_ratio = emp / pop) %&gt;%
  select(countrycode, country, year, emp_pop_ratio)
pwt91
# A tibble: 12,376 × 4
   countrycode country  year emp_pop_ratio
   &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt;         &lt;dbl&gt;
 1 ABW         Aruba    1950            NA
 2 ABW         Aruba    1951            NA
 3 ABW         Aruba    1952            NA
 4 ABW         Aruba    1953            NA
 5 ABW         Aruba    1954            NA
 6 ABW         Aruba    1955            NA
 7 ABW         Aruba    1956            NA
 8 ABW         Aruba    1957            NA
 9 ABW         Aruba    1958            NA
10 ABW         Aruba    1959            NA
# … with 12,366 more rows</code></pre>
<p>Let’s do some simple counting to get a good sense of our data:</p>
<pre class="r"><code># Number of countries
cat(length(unique(pwt91$country)))
182
# Number of years covered in this data set
cat(length(unique(pwt91$year)))
68
# Make sure that country and countrycode are consistent
cat(length(unique(pwt91$countrycode)))
182
# First and last year
cat(min(pwt91$year))
1950
cat(max(pwt91$year))
2017</code></pre>
<p>Notice that there are lots of NA’s, i.e., for some combination of country and year, there are no data. More succinctly put, the further back we go in time, the more we observe missing values for countries. Also, I expect that some countries would have more missing values than others. Before we trim the sample down, we want to examine the number missing values by year and by country to see if this is indeed the widespread trend:</p>
<pre class="r"><code>pwt91 %&gt;%
  group_by(year) %&gt;%
  count(is.na(emp_pop_ratio))
# A tibble: 136 × 3
# Groups:   year [68]
    year `is.na(emp_pop_ratio)`     n
   &lt;dbl&gt; &lt;lgl&gt;                  &lt;int&gt;
 1  1950 FALSE                     50
 2  1950 TRUE                     132
 3  1951 FALSE                     54
 4  1951 TRUE                     128
 5  1952 FALSE                     55
 6  1952 TRUE                     127
 7  1953 FALSE                     57
 8  1953 TRUE                     125
 9  1954 FALSE                     61
10  1954 TRUE                     121
# … with 126 more rows</code></pre>
<p>After examining the table above, I find that the count confirms my thinking. True indicates the count for missing values, and False indicates the opposite. The first two decades over this period of 68 years (1950-2017) have many coutries with missing values, i.e. &gt; 100 countries in our sample of 182 have missing values. As we go into the 1990’s, the number of countries with missing values drastically decreases, i.e., <span class="math inline">\(\leq\)</span> 10 countires have missing values.</p>
<pre class="r"><code>pwt91 %&gt;%
  group_by(country) %&gt;%
  count(is.na(emp_pop_ratio))
# A tibble: 312 × 3
# Groups:   country [182]
   country             `is.na(emp_pop_ratio)`     n
   &lt;chr&gt;               &lt;lgl&gt;                  &lt;int&gt;
 1 Albania             FALSE                     48
 2 Albania             TRUE                      20
 3 Algeria             FALSE                     58
 4 Algeria             TRUE                      10
 5 Angola              FALSE                     48
 6 Angola              TRUE                      20
 7 Anguilla            FALSE                     29
 8 Anguilla            TRUE                      39
 9 Antigua and Barbuda FALSE                      9
10 Antigua and Barbuda TRUE                      59
# … with 302 more rows</code></pre>
<p>OECD members such as the US, UK, Australia, Canada, France, Finland, Germany, etc., have no missing values over this period. Sub-Saharan African countries, in particular, have relatively more missing values. Then, some Latin American countries have even more missing values. This is to be expected with socio-economic data; we confirm that the sample introduces much bias. Deleting missing observations can result in biased parameters and estimates and reduce the statistical power of the analysis. However, in this case, I would be using listwise deletion, where all observations that have missing values are deleted. This implies that, if I were to continue with my analysis, it would only be done on countries that have a complete set of data. While there may be better ways to handle biased samples, for this activity, I would simply use the year 1990 as a cutt off since a reasonable number of countries would have values from 1990 to 2017:</p>
<pre class="r"><code>pwt91 &lt;- pwt91 %&gt;%
  filter(year &gt;= 1990) %&gt;%
  na.exclude()</code></pre>
<p>We count the number of rows for each country to see which coutries do not have all 28 years (1990-2017); we drop those countires:</p>
<pre class="r"><code>pwt91 &lt;- pwt91 %&gt;%
  group_by(countrycode) %&gt;%
  filter(n() == 28)</code></pre>
<p>Let’s check:</p>
<pre class="r"><code>pwt91 %&gt;%
  group_by(countrycode) %&gt;%
  count()
# A tibble: 169 × 2
# Groups:   countrycode [169]
   countrycode     n
   &lt;chr&gt;       &lt;int&gt;
 1 AGO            28
 2 ALB            28
 3 ARE            28
 4 ARG            28
 5 ARM            28
 6 AUS            28
 7 AUT            28
 8 AZE            28
 9 BDI            28
10 BEL            28
# … with 159 more rows
# Number of countries
cat(length(unique(pwt91$countrycode)))
169</code></pre>
<p>As can be seen, all remaining countries have values for the 28-year period; we have a sample of 169 countries:</p>
<pre class="r"><code>pwt91
# A tibble: 4,732 × 4
# Groups:   countrycode [169]
   countrycode country  year emp_pop_ratio
   &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt;         &lt;dbl&gt;
 1 AGO         Angola   1990         0.454
 2 AGO         Angola   1991         0.451
 3 AGO         Angola   1992         0.449
 4 AGO         Angola   1993         0.448
 5 AGO         Angola   1994         0.445
 6 AGO         Angola   1995         0.442
 7 AGO         Angola   1996         0.439
 8 AGO         Angola   1997         0.438
 9 AGO         Angola   1998         0.437
10 AGO         Angola   1999         0.437
# … with 4,722 more rows</code></pre>
</div>
<div id="merging-data-sets" class="section level2">
<h2>Merging Data Sets</h2>
<p>Suppose after we completed our analysis, we found another data set containing some other relevant variables. We would like to “join” the two data sets by a common variable. In my case, that common variable is “countrycode.” We start by loading in the second data set, which I’ve converted to a .csv file for convenience:</p>
<pre class="r"><code>as_tibble(cnts19)
# A tibble: 17,520 × 195
   code  Wbcode country      year  area1  area2 area3 computer1 computer2 computer3
   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 0010  AFG    Afghanistan  1919 647000 250000    NA        NA        NA        NA
 2 0010  AFG    Afghanistan  1920 647000 250000    NA        NA        NA        NA
 3 0010  AFG    Afghanistan  1921 647000 250000    NA        NA        NA        NA
 4 0010  AFG    Afghanistan  1922 647000 250000    NA        NA        NA        NA
 5 0010  AFG    Afghanistan  1923 647000 250000    NA        NA        NA        NA
 6 0010  AFG    Afghanistan  1924 647000 250000    NA        NA        NA        NA
 7 0010  AFG    Afghanistan  1925 647000 250000    NA        NA        NA        NA
 8 0010  AFG    Afghanistan  1926 647000 250000    NA        NA        NA        NA
 9 0010  AFG    Afghanistan  1927 647000 250000    NA        NA        NA        NA
10 0010  AFG    Afghanistan  1928 647000 250000    NA        NA        NA        NA
# … with 17,510 more rows, and 185 more variables: computer4 &lt;dbl&gt;,
#   computer5 &lt;dbl&gt;, computer6 &lt;dbl&gt;, delta01 &lt;dbl&gt;, delta02 &lt;dbl&gt;,
#   delta03 &lt;dbl&gt;, delta04 &lt;dbl&gt;, delta05 &lt;dbl&gt;, delta06 &lt;dbl&gt;, delta07 &lt;dbl&gt;,
#   delta08 &lt;dbl&gt;, delta09 &lt;dbl&gt;, delta10 &lt;dbl&gt;, delta11 &lt;dbl&gt;, delta12 &lt;dbl&gt;,
#   delta13 &lt;dbl&gt;, delta14 &lt;dbl&gt;, delta15 &lt;dbl&gt;, delta16 &lt;dbl&gt;, delta17 &lt;dbl&gt;,
#   delta18 &lt;dbl&gt;, delta19 &lt;dbl&gt;, delta20 &lt;dbl&gt;, delta21 &lt;dbl&gt;, delta22 &lt;dbl&gt;,
#   delta23 &lt;dbl&gt;, delta24 &lt;dbl&gt;, delta25 &lt;dbl&gt;, delta26 &lt;dbl&gt;, …</code></pre>
<p>First we need to make sure that the “key” variables share the same names across these two data sets. Then, we “select” the variables of interest to us. Domestic8 is the number of anti-government demonstrations, which, according to the CNTS user manual, includes labor strikes and demonstrations.</p>
<pre class="r"><code>cnts19 &lt;- cnts19 %&gt;%
  rename(countrycode = Wbcode) %&gt;%
  select(countrycode, year, domestic8)</code></pre>
<p>We would want to use left_join(), because it preserves the original observations even when there isn’t a match. Notice that setting the argument (by = NULL) makes sure that R uses all variables that appear in both data sets for merging, this is the so-called <strong>natural join</strong>.</p>
<pre class="r"><code>new_data &lt;- pwt91 %&gt;%
  left_join(cnts19, by = NULL) %&gt;%
  na.exclude()
Joining, by = c(&quot;countrycode&quot;, &quot;year&quot;)
new_data
# A tibble: 4,455 × 5
# Groups:   countrycode [162]
   countrycode country  year emp_pop_ratio domestic8
   &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
 1 AGO         Angola   1990         0.454         0
 2 AGO         Angola   1991         0.451         0
 3 AGO         Angola   1992         0.449         0
 4 AGO         Angola   1993         0.448         0
 5 AGO         Angola   1994         0.445         0
 6 AGO         Angola   1995         0.442         0
 7 AGO         Angola   1996         0.439         0
 8 AGO         Angola   1997         0.438         0
 9 AGO         Angola   1998         0.437         0
10 AGO         Angola   1999         0.437         0
# … with 4,445 more rows</code></pre>
<p>Let’s check:</p>
<pre class="r"><code>new_data %&gt;%
  group_by(countrycode) %&gt;%
  count()
# A tibble: 162 × 2
# Groups:   countrycode [162]
   countrycode     n
   &lt;chr&gt;       &lt;int&gt;
 1 AGO            28
 2 ALB            28
 3 ARE            28
 4 ARG            28
 5 ARM            26
 6 AUS            28
 7 AUT            28
 8 AZE            26
 9 BDI            28
10 BEL            28
# … with 152 more rows</code></pre>
<p>According to the table above, after merging, we now have some countries with missing values for the domestic8 variable. Since this exercise is about data wrangling techniques and not about data analysis, we will continute to trim the sample further for the sake of practicing, excluding countries that have missing values. We need to keep in mind that, as far as analysis is concerned, too much deletion of data would lead to biases, 100<span class="math inline">\(\%\)</span>. Just how much bias are we able to tolerate is a whole new topic of discussion. For now, we will proceed:</p>
<pre class="r"><code>new_data &lt;- new_data %&gt;%
  group_by(countrycode) %&gt;%
  filter(n() == 28)</code></pre>
<p>Now, let’s check:</p>
<pre class="r"><code>new_data %&gt;%
  group_by(countrycode) %&gt;%
  count()
# A tibble: 139 × 2
# Groups:   countrycode [139]
   countrycode     n
   &lt;chr&gt;       &lt;int&gt;
 1 AGO            28
 2 ALB            28
 3 ARE            28
 4 ARG            28
 5 AUS            28
 6 AUT            28
 7 BDI            28
 8 BEL            28
 9 BEN            28
10 BFA            28
# … with 129 more rows</code></pre>
<p>We have ensured that all remaining countries have values for all varaibles:</p>
<pre class="r"><code># Number of countries
cat(length(unique(new_data$countrycode)))
139
new_data
# A tibble: 3,892 × 5
# Groups:   countrycode [139]
   countrycode country  year emp_pop_ratio domestic8
   &lt;chr&gt;       &lt;chr&gt;   &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
 1 AGO         Angola   1990         0.454         0
 2 AGO         Angola   1991         0.451         0
 3 AGO         Angola   1992         0.449         0
 4 AGO         Angola   1993         0.448         0
 5 AGO         Angola   1994         0.445         0
 6 AGO         Angola   1995         0.442         0
 7 AGO         Angola   1996         0.439         0
 8 AGO         Angola   1997         0.438         0
 9 AGO         Angola   1998         0.437         0
10 AGO         Angola   1999         0.437         0
# … with 3,882 more rows</code></pre>
<p>Here’s glimpse at which country had the single most yearly anti-government demonstrations over this 28-year period</p>
<pre class="r"><code>new_data %&gt;%
  arrange(desc(domestic8))
# A tibble: 3,892 × 5
# Groups:   countrycode [139]
   countrycode country               year emp_pop_ratio domestic8
   &lt;chr&gt;       &lt;chr&gt;                &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
 1 IND         India                 2016         0.401       149
 2 IND         India                 2017         0.402       146
 3 IND         India                 2015         0.399       110
 4 USA         United States         2015         0.470        81
 5 SYR         Syrian Arab Republic  2011         0.237        74
 6 PAK         Pakistan              2016         0.307        55
 7 YEM         Yemen                 2011         0.185        55
 8 USA         United States         2014         0.466        50
 9 USA         United States         2011         0.457        49
10 USA         United States         2016         0.474        49
# … with 3,882 more rows</code></pre>
</div>
<div id="nested-data" class="section level2">
<h2>Nested Data</h2>
<p>Lastly, we may also present our new merged data as a nested data frame, a new structure. The nested data frame has one row per group (per countrycode/country in my case). The third column, data, is a list of data frames:</p>
<pre class="r"><code>nested_data &lt;- new_data %&gt;%
  group_by(countrycode, country) %&gt;%
  nest()
nested_data
# A tibble: 139 × 3
# Groups:   countrycode, country [139]
   countrycode country              data             
   &lt;chr&gt;       &lt;chr&gt;                &lt;list&gt;           
 1 AGO         Angola               &lt;tibble [28 × 3]&gt;
 2 ALB         Albania              &lt;tibble [28 × 3]&gt;
 3 ARE         United Arab Emirates &lt;tibble [28 × 3]&gt;
 4 ARG         Argentina            &lt;tibble [28 × 3]&gt;
 5 AUS         Australia            &lt;tibble [28 × 3]&gt;
 6 AUT         Austria              &lt;tibble [28 × 3]&gt;
 7 BDI         Burundi              &lt;tibble [28 × 3]&gt;
 8 BEL         Belgium              &lt;tibble [28 × 3]&gt;
 9 BEN         Benin                &lt;tibble [28 × 3]&gt;
10 BFA         Burkina Faso         &lt;tibble [28 × 3]&gt;
# … with 129 more rows</code></pre>
<p>If we look at the first element of “data,” we see that it contains all the data for that country (in my case, Angola):</p>
<pre class="r"><code>nested_data$data[[1]]
# A tibble: 28 × 3
    year emp_pop_ratio domestic8
   &lt;dbl&gt;         &lt;dbl&gt;     &lt;dbl&gt;
 1  1990         0.454         0
 2  1991         0.451         0
 3  1992         0.449         0
 4  1993         0.448         0
 5  1994         0.445         0
 6  1995         0.442         0
 7  1996         0.439         0
 8  1997         0.438         0
 9  1998         0.437         0
10  1999         0.437         0
# … with 18 more rows</code></pre>
<p>Presenting data in this new structure can be helpful, especially when dealing with cross-sectional data.</p>
</div>
<div id="conlusion" class="section level2">
<h2>Conlusion</h2>
<p>We began with a sample of 182 countries, which we trimmed down to 139. Judging by numbers only, the deletion process could have been worse. However, we must take note that, when it comes to missing values, the data are not missing completely at random (MCAR). This is especially true for cross-national socio-economic data, where sampling quality reflects inequalities that are rather hard to capture and deal with. Beyond this activity, it would be interesting to explore ways of handling missing data as well as new imputation methods that have been developed over the years.</p>
</div>

    </div>

    






<div class="article-tags">
  
  <a class="badge badge-light" href="YangWu1227.github.io/tag/tidyverse/">Tidyverse</a>
  
  <a class="badge badge-light" href="YangWu1227.github.io/tag/economics/">Economics</a>
  
  <a class="badge badge-light" href="YangWu1227.github.io/tag/data-wrangling/">Data Wrangling</a>
  
  <a class="badge badge-light" href="YangWu1227.github.io/tag/relational-database/">Relational Database</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=YangWu1227.github.io/post/data-wrangling-in-economics/&amp;text=Data%20Wrangling%20with%20Economics%20Data" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=YangWu1227.github.io/post/data-wrangling-in-economics/&amp;t=Data%20Wrangling%20with%20Economics%20Data" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Data%20Wrangling%20with%20Economics%20Data&amp;body=YangWu1227.github.io/post/data-wrangling-in-economics/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=YangWu1227.github.io/post/data-wrangling-in-economics/&amp;title=Data%20Wrangling%20with%20Economics%20Data" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="whatsapp://send?text=Data%20Wrangling%20with%20Economics%20Data%20YangWu1227.github.io/post/data-wrangling-in-economics/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=YangWu1227.github.io/post/data-wrangling-in-economics/&amp;title=Data%20Wrangling%20with%20Economics%20Data" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>











  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="YangWu1227.github.io"><img class="avatar mr-3 avatar-circle" src="/YangWu1227.github.io/author/yang-ken-wu/avatar_hu5209c67c5d796189810bebc1ea7397e2_2226757_270x270_fill_q75_lanczos_center.jpg" alt="Yang (Ken) Wu"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="YangWu1227.github.io">Yang (Ken) Wu</a></h5>
      
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.instagram.com/kennywu12/" target="_blank" rel="noopener">
        <i class="fab fa-instagram"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/YangWu1227/" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://stackoverflow.com/users/12923148/yang-wu/" target="_blank" rel="noopener">
        <i class="ai ai-stackoverflow"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/yangwu1227/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>
















  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="YangWu1227.github.io/project/pay-in-the-wnba/">Gender Pay Gap in Professional Sports</a></li>
      
    </ul>
  </div>
  





  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  
  <p class="powered-by">
    © 2021 Yang Wu
  </p>
  

  
  






  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/python.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/latex.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    <script src="/YangWu1227.github.io/js/bootstrap.bundle.min.6aed84840afc03ab4d5750157f69c120.js"></script>

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/YangWu1227.github.io/en/js/wowchemy.min.724d9ce101009dc174ad243758e6a6fe.js"></script>

    
  <script async defer src="https://buttons.github.io/buttons.js"></script>




</body>
</html>
